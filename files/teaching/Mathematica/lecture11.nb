(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    246849,       7322]
NotebookOptionsPosition[    231900,       6905]
NotebookOutlinePosition[    232941,       6948]
CellTagsIndexPosition[    232819,       6941]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " as a Tool for Astronomy and Physics"
}], "Title",
 CellChangeTimes->{{3.4631492689871325`*^9, 3.4631492808119326`*^9}}],

Cell["\<\
Lecture 11
Wintersemester 2009/10

Markus R\[ODoubleDot]llig\
\>", "Subtitle",
 CellChangeTimes->{{3.4631492844155326`*^9, 3.463149301715933*^9}, {
   3.463149446339533*^9, 3.4631494500679326`*^9}, {3.463150895378133*^9, 
   3.4631508957369328`*^9}, {3.4631509331145325`*^9, 
   3.4631509348461323`*^9}, {3.4633918330178003`*^9, 3.4633918441094*^9}, {
   3.4633924180713997`*^9, 3.4633924208326*^9}, 3.4633925658190002`*^9, 
   3.464937683525*^9, 3.4654667940002003`*^9, 3.4661610144728003`*^9, 
   3.466824617671341*^9, 3.46772120193779*^9, {3.469855652163376*^9, 
   3.4698556523033752`*^9}}],

Cell[CellGroupData[{

Cell["Differential Equations", "Section",
 CellChangeTimes->{{3.46820906255828*^9, 3.468209077487506*^9}}],

Cell[TextData[{
 "Required Reading\n\n",
 ButtonBox["Differential Equations",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DifferentialEquations"],
 "\n",
 ButtonBox["Differential Equations\n",
  BaseStyle->"Link",
  ButtonData->"paclet:guide/DifferentialEquations"],
 ButtonBox["Differential Equation Solving with DSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DSolveOverview"],
 "\n"
}], "Text",
 CellChangeTimes->{{3.4682090869099226`*^9, 3.4682090913715305`*^9}, {
  3.4682091226963854`*^9, 3.4682091565701003`*^9}, {3.4682092655050917`*^9, 
  3.468209354215678*^9}, {3.4698534836701717`*^9, 3.469853591818376*^9}}],

Cell[TextData[{
 "The basic command to solve a differential equation symbolically is DSolve. ",
 Cell[BoxData[
  RowBox[{
   ButtonBox["DSolve",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/DSolve"], "[", 
   RowBox[{
    StyleBox["eqn", "TI"], ",", 
    StyleBox["y", "TI"], ",", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula"],
 "solves a differential equation for the function ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula"],
 ", with independent variable\[NonBreakingSpace]",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 ". The result of a successfully solved differential equation is a list of \
lists of rules\[LongDash]structurally, like the result of ",
 StyleBox["Solve", "MR"],
 ".  ",
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " can handle the following types of equations:\n"
}], "Text",
 CellChangeTimes->{{3.468209629259761*^9, 3.4682096702566333`*^9}, 
   3.468209842995736*^9, {3.4682098971278315`*^9, 3.4682099482179213`*^9}, {
   3.468209985751587*^9, 3.468209990696796*^9}, {3.4698536214284286`*^9, 
   3.469853649922471*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Ordinary Differential Equations ",
  FontSlant->"Italic"],
 StyleBox["(ODEs)",
  FontVariations->{"CompatibilityType"->0}],
 ", in which there is a single independent variable ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]], "InlineMath"],
 " and one or more dependent variables ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], "(", "t", ")"}], TraditionalForm]], "InlineMath"],
 ". ",
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " is equipped with a wide variety of techniques for solving single ODEs as \
well as systems of ODEs."
}], "Item",
 CellTags->"b:0.0",
 CellID->6493],

Cell[TextData[{
 StyleBox["Partial Differential Equations",
  FontSlant->"Italic"],
 " (PDEs), in which there are two or more independent variables and one \
dependent variable. Finding exact symbolic solutions of PDEs is a difficult \
problem, but ",
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " can solve most first-order PDEs and a limited number of the second-order \
PDEs found in standard reference books."
}], "Item",
 CellTags->"b:0.0",
 CellID->1515],

Cell[TextData[{
 StyleBox["Differential-Algebraic Equations",
  FontSlant->"Italic"],
 " (DAEs), in which some members of the system are differential equations and \
the others are purely algebraic, having no derivatives in them. As with PDEs, \
it is difficult to find exact solutions to DAEs, but ",
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " can solve many examples of such systems that occur in applications."
}], "Item",
 CellTags->"b:0.0",
 CellID->25269]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbolic Solution to ODE's", "Subsection",
 CellChangeTimes->{{3.468240314668209*^9, 3.4682403228894234`*^9}, 
   3.469854262391406*^9}],

Cell[TextData[{
 "Required Reading\n\n",
 ButtonBox["Overview of Ordinary Differential Equations (ODEs)",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DSolveIntroductionToODEs"]
}], "Text",
 CellChangeTimes->{{3.469854586603861*^9, 3.4698546019138823`*^9}}],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   ButtonBox["DSolve",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/DSolve"], "[", 
   RowBox[{
    StyleBox["eqn", "TI"], ",", 
    RowBox[{
     StyleBox["y", "TI"], "[", 
     StyleBox["x", "TI"], "]"}], ",", 
    StyleBox["x", "TI"]}], "]"}]]],
 " ",
 Cell[BoxData[Cell[TextData[{
   "solve a differential equation for ",
   Cell[BoxData[
    FormBox[
     RowBox[{"y", "[", "x", "]"}], TraditionalForm]], "InlineMath"]
  }], "TableText"]]],
 "\n",
 Cell[BoxData[
  RowBox[{
   ButtonBox["DSolve",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/DSolve"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["eqn", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["eqn", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["1", "TR"]], "[", 
       StyleBox["x", "TI"], "]"}], ",", 
      RowBox[{
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["2", "TR"]], "[", 
       StyleBox["x", "TI"], "]"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    StyleBox["x", "TI"]}], "]"}]]],
 " ",
 Cell[BoxData[Cell[TextData[{
   "solve a system of differential equations for ",
   Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["y", "i"], "[", "x", "]"}], TraditionalForm]], "InlineMath"]
  }], "TableText"]]],
 "\n"
}], "Text",
 CellChangeTimes->{{3.469853678746519*^9, 3.469853705448557*^9}}],

Cell[TextData[{
 " One of the simplest differential equations is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["y", "\[Prime]",
      MultilineFunction->None], "(", "x", ")"}], "\[LongEqual]", 
    RowBox[{"y", "(", "x", ")"}]}], TraditionalForm]]],
 " ."
}], "Text",
 CellChangeTimes->{{3.468209629259761*^9, 3.4682096702566333`*^9}, 
   3.468209842995736*^9, {3.4682098971278315`*^9, 3.4682099482179213`*^9}, {
   3.468209985751587*^9, 3.468209990696796*^9}, {3.4698536214284286`*^9, 
   3.469853649922471*^9}, 3.4698537146185703`*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"y", "'"}], "[", "x", "]"}], "\[Equal]", 
    RowBox[{"y", "[", "x", "]"}]}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.46820984499254*^9, 3.4682098724485884`*^9}}],

Cell[TextData[{
 "You can pick out a specific solution by using ",
 Cell[BoxData["/."], "InlineFormula"],
 " (",
 Cell[BoxData[
  ButtonBox["ReplaceAll",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/ReplaceAll"]], "InlineFormula"],
 ")."
}], "Text",
 CellChangeTimes->{3.469853735284603*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "[", "x", "]"}], "/.", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "\[Equal]", 
      RowBox[{"y", "[", "x", "]"}]}], "}"}], ",", " ", 
    RowBox[{"y", "[", "x", "]"}], ",", " ", "x"}], "]"}]}]], "Input"],

Cell["\<\
Integration constants are given as C[n]. If we provide initial conditions we \
get particular solution. The condition has not to be numeric. Symbolic \
conditions work as well\
\>", "Text",
 CellChangeTimes->{{3.468210017466443*^9, 3.4682100537209063`*^9}, {
  3.4682100876977663`*^9, 3.468210094780179*^9}, {3.468210163264299*^9, 
  3.468210202607568*^9}, {3.46985375354663*^9, 3.4698537569866343`*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "\[Equal]", 
      RowBox[{"y", "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "a"}]}], "}"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.46820984499254*^9, 3.4682098724485884`*^9}, {
  3.4682100959657807`*^9, 3.4682101544190836`*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "\[Equal]", 
      RowBox[{"y", "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "2"}]}], "}"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.46820984499254*^9, 3.4682098724485884`*^9}, {
  3.4682100959657807`*^9, 3.4682101544190836`*^9}, {3.468210205758774*^9, 
  3.468210208925579*^9}}],

Cell[TextData[{
 "You can also ask ",
 ButtonBox["DSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/DSolve"],
 " to use a different set of integration constants by using the option \
GeneratedParameters:"
}], "Text",
 CellChangeTimes->{{3.4682397336916575`*^9, 3.4682397552040954`*^9}, {
  3.4682398020041776`*^9, 3.468239818259406*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", "x", "]"}], "\[Equal]", 
     RowBox[{"y", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x", ",", 
   RowBox[{
    StyleBox["GeneratedParameters",
     FontWeight->"Bold"], "\[Rule]", "\[CapitalSampi]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.46820984499254*^9, 3.4682098724485884`*^9}, {
  3.4682100959657807`*^9, 3.4682101544190836`*^9}, {3.468210205758774*^9, 
  3.468210208925579*^9}, {3.4682397597749033`*^9, 3.468239789102955*^9}}],

Cell[TextData[{
 "One way to visualize differential equations is by plotting the so-called \
direction field. This is related to the geometrical interpretation of a \
differential equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[DifferentialD]", "y"}], 
     RowBox[{"\[DifferentialD]", "x"}]], "=", 
    RowBox[{"f", "(", 
     RowBox[{"x", ",", "y"}], ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".Suppose that a solution to this equation is a function \[Phi](x), so a \
solution is the graph of the function \[Phi]. Therefore, if (x, y) \:f39fis a \
point on this graph, the slope of the tangent line is given by f (x, y). A \
set of short line segments representing the tangent lines can be constructed \
for a large number of points. This collection of line segments is known as \
the direction field of the differential equation and provides a great deal of \
information concerning the behavior of the family of solutions. ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " offers the function ",
 ButtonBox["VectorPlot",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/VectorPlot"],
 " and ",
 ButtonBox["VectorPlot3D",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/VectorPlot3D"],
 " to visualize the direction field."
}], "Text",
 CellChangeTimes->{{3.4721889674939795`*^9, 3.472188981409204*^9}, {
  3.47218906457295*^9, 3.4721891090174284`*^9}, {3.4721891461766934`*^9, 
  3.472189232636051*^9}, {3.472189285473344*^9, 3.4721893656886845`*^9}, {
  3.4721894329872026`*^9, 3.4721894783052826`*^9}}],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   ButtonBox["VectorPlot",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/VectorPlot"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["v", "TI"], 
       StyleBox["x", "TI"]], ",", 
      SubscriptBox[
       StyleBox["v", "TI"], 
       StyleBox["y", "TI"]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["x", "TI"], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["min", "TI"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["max", "TI"]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["y", "TI"], ",", 
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["min", "TI"]], ",", 
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["max", "TI"]]}], "}"}]}], "]"}]], "InlineFormula"],
 "  ",
 "generates a vector plot of the vector field ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["v", "TI"], 
     StyleBox["x", "TI"]], ",", 
    SubscriptBox[
     StyleBox["v", "TI"], 
     StyleBox["y", "TI"]]}], "}"}]], "InlineFormula"],
 " as a function of ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 " and ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula"],
 ". Our example ODE from above has the following direction field:"
}], "Text",
 CellChangeTimes->{{3.4721895197389555`*^9, 3.4721895482402053`*^9}}],

Cell[BoxData[
 RowBox[{"VectorPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4721895493478074`*^9, 3.4721895540122156`*^9}, {
  3.472189610999116*^9, 3.472189645256776*^9}}],

Cell["\<\
A particular solution to the ODE overlayed to the direction field:\
\>", "Text",
 CellChangeTimes->{{3.472189682540841*^9, 3.4721897275937204`*^9}, {
  3.472189760868579*^9, 3.472189765127386*^9}, {3.4721898493207345`*^9, 
  3.4721898553423448`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{"%", ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Exp", "[", "x", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.472189869007969*^9, 3.4721898967448177`*^9}, {
  3.4721901866713266`*^9, 3.472190221474988*^9}}],

Cell["\<\
Another way to visualize the behavior of differential eqautions is by \
plotting various solutions for different initial conditions\
\>", "Text",
 CellChangeTimes->{{3.4722182529577007`*^9, 3.472218283930986*^9}}],

Cell[BoxData[{
 RowBox[{"sol", "=", " ", 
  RowBox[{"DSolve", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", " ", "x", "]"}], "==", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"x", "^", "2"}], "-", 
       RowBox[{"y", "[", "x", "]"}]}], 
      RowBox[{"x", "+", 
       RowBox[{"y", "[", "x", "]"}]}]]}], ",", "y", ",", "x"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"particularSolutions", " ", "=", 
   RowBox[{"Table", "[", "\n", 
    RowBox[{
     RowBox[{"Tooltip", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "x", "]"}], "/.", "sol"}], "/.", 
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "->", " ", "k"}]}], ",", "k"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Plot", "[", 
  RowBox[{"particularSolutions", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4722182966757355`*^9, 3.4722184530492496`*^9}}],

Cell[TextData[{
 "The differential equation has to be given by using the y'[x] (",
 ButtonBox["Derivative",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/Derivative"],
 ") command or D[f,x] (",
 ButtonBox["D or \[PartialD]",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/D"],
 " )."
}], "Text",
 CellChangeTimes->{{3.4682102716220894`*^9, 3.4682104094171314`*^9}, {
  3.4698527257719793`*^9, 3.4698527257819796`*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"y", "''"}], "[", "x", "]"}], "\[Equal]", 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.46820984499254*^9, 3.4682098724485884`*^9}, {
  3.4682100959657807`*^9, 3.4682101544190836`*^9}, {3.468210205758774*^9, 
  3.468210208925579*^9}, {3.468210414861541*^9, 3.468210464360428*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"y", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    SuperscriptBox["x", "2"]}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.46820984499254*^9, 3.4682098724485884`*^9}, {
  3.4682100959657807`*^9, 3.4682101544190836`*^9}, {3.468210205758774*^9, 
  3.468210208925579*^9}, {3.468210414861541*^9, 3.4682105138437147`*^9}}],

Cell[TextData[{
 "Here is a more complicated example. Similar to the results of ",
 StyleBox["Integrate", "MR"],
 " and ",
 StyleBox["Sum", "MR"],
 ", ",
 StyleBox["DSolve", "MR"],
 "\[Hyphen]results often contain special functions, ",
 StyleBox["Root", "MR"],
 "\[Hyphen]objects, and ",
 StyleBox["RootSum", "MR"],
 "\[Hyphen]objects."
}], "Text",
 CellChangeTimes->{3.468210551424181*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", "x", "]"}], " ", "==", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", "x", "]"}], "^", "2"}], " ", "-", " ", "x"}]}], 
    "}"}], ",", " ", 
   RowBox[{"y", "[", "x", "]"}], ",", " ", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.468210668105223*^9, 3.4682106969964743`*^9}, 
   3.468210734093339*^9}],

Cell[BoxData[
 RowBox[{"VectorPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      SuperscriptBox["y", "2"], "-", "x"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4721903404875965`*^9, 3.472190373076054*^9}, {
  3.4721904086597166`*^9, 3.472190424150544*^9}}],

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "x", "]"}], " ", "==", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "x", "]"}], "^", "2"}], " ", "-", " ", "x"}]}], 
      ",", 
      RowBox[{
       RowBox[{"y", "[", "0", "]"}], "\[Equal]", "1"}]}], "}"}], ",", " ", 
    "y", ",", " ", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.468210668105223*^9, 3.4682106969964743`*^9}, 
   3.468210734093339*^9, {3.4682415623128967`*^9, 3.468241585931338*^9}, {
   3.4682416473642454`*^9, 3.4682416479726467`*^9}, {3.4682417810564804`*^9, 
   3.4682418014769163`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{"%%", ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", "x", "]"}], "/.", "sol"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.472190443525778*^9, 3.4721904813870444`*^9}}],

Cell[TextData[{
 "The specification of the functions in the second argument of ",
 StyleBox["DSolve", "MR"],
 " is analogous to that for ",
 StyleBox["NDSolve", "MR"],
 "; that is, if no argument is specified for the function to be found, ",
 StyleBox["DSolve", "MR"],
 " returns a pure function (with the dummy variable typically being the \
independent variable from the input equations). Here this is demonstrated \
using the simple differential equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["y", "\[DoublePrime]"], "(", "x", ")"}], "=", 
    RowBox[{"-", 
     RowBox[{"y", "(", "x", ")"}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{3.468211045766287*^9}],

Cell[BoxData[
 RowBox[{"y1", "=", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "+", 
      RowBox[{"y", "[", "x", "]"}]}], "\[Equal]", 
     RowBox[{"a", " ", 
      RowBox[{"Sin", "[", "x", "]"}]}]}], ",", 
    RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4682109091256466`*^9, 3.4682109444285088`*^9}}],

Cell[BoxData[
 RowBox[{"y2", "=", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "+", 
      RowBox[{"y", "[", "x", "]"}]}], "\[Equal]", 
     RowBox[{"a", " ", 
      RowBox[{"Sin", "[", "x", "]"}]}]}], ",", "y", ",", "x"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4682097421883593`*^9, 3.468209744653164*^9}, {
  3.4682109138212547`*^9, 3.4682109419169044`*^9}}],

Cell["\<\
SInce the solution is given as a pure function named y without specifying the \
argument it can be used to replace any instance of y[anyArgument].\
\>", "Text",
 CellChangeTimes->{{3.4682111600988874`*^9, 3.468211223481799*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y", " ", "/.", " ", "y2"}], ",", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", " ", 
        RowBox[{"y", "[", "z", "]"}]}], ")"}], " ", "/.", " ", "y2"}], ",", 
     " ", "z"}], "]"}]}], "}"}]], "Input"],

Cell["\<\
y1 can not be used in the same way. y[z] does not match y[x] and so the \
integrand is not replaced.\
\>", "Text",
 CellChangeTimes->{{3.4682110821767507`*^9, 3.46821113888285*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y", " ", "/.", " ", "y1"}], ",", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", " ", 
        RowBox[{"y", "[", "z", "]"}]}], ")"}], " ", "/.", " ", "y1"}], ",", 
     " ", "z"}], "]"}]}], "}"}]], "Input"],

Cell[TextData[{
 "Because of the pure function form of the solution, arbitrary derivatives ",
 StyleBox["Derivative[", "MR"],
 StyleBox["n", "TI"],
 StyleBox["][", "MR"],
 StyleBox["solution", "TI"],
 StyleBox["]", "MR"],
 " can also be immediately replaced. "
}], "Text",
 CellChangeTimes->{3.4682112980031295`*^9}],

Cell["\<\
You can use the replacement, e.g. if you want to plot the solution\
\>", "Text",
 CellChangeTimes->{{3.4682418419901876`*^9, 3.4682418618178225`*^9}}],

Cell[BoxData[{
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "''"}], "[", "x", "]"}], "-", 
       RowBox[{"x", " ", 
        RowBox[{"y", "[", "x", "]"}]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "9", "]"}], "\[Equal]", "1"}]}], "}"}], ",", "y", ",",
    "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "x", "]"}], "/.", "%"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4682418652498283`*^9, 3.4682418717082396`*^9}}],

Cell["\<\
Often you will encounter special functions on the solution of differential \
equations\
\>", "Text",
 CellChangeTimes->{{3.468211329343585*^9, 3.4682113650520477`*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"w", "'"}], "[", "z", "]"}], " ", "==", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"z", "^", "2"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"w", "[", "0", "]"}], " ", "==", " ", "0"}]}], "}"}], ",", " ", 
   "w", ",", " ", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.4682113808392754`*^9, 3.4682113837876806`*^9}}],

Cell[TextData[{
 "Often ",
 ButtonBox["DSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/DSolve"],
 " can integrate the differential equation but ",
 ButtonBox["Solve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/Solve"],
 " can not resolve the resulting equation for the dependant variables. The \
solution is the given in implicit form or using InverseFunction[function]."
}], "Text",
 CellChangeTimes->{{3.46821162836491*^9, 3.4682117033074417`*^9}, {
  3.4682393339973235`*^9, 3.468239346664546*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", "x", "]"}], " ", "==", " ", 
     RowBox[{"Log", "@", 
      RowBox[{"y", "[", "x", "]"}]}]}], "}"}], " ", ",", " ", "y", ",", " ", 
   "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.4682114128817315`*^9, 3.4682114345813694`*^9}, {
  3.4682114678874283`*^9, 3.468211573156413*^9}}],

Cell[TextData[{
 "Although the initial conditions are usually specified in terms of simple \
equations like ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "[", "0", "]"}], "\[Equal]", 
    SubscriptBox["x", "0"]}], TraditionalForm]]],
 ", it is also possible to use more complicated equations whose solutions may \
include several sets of  initial conditions, in which case ",
 " ",
 ButtonBox["DSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/DSolve"],
 " produces several solutions to the differential equation.  The following \
variation of the shm problem appears contrived, but illustrates the idea."
}], "Text",
 CellChangeTimes->{{3.468239918770383*^9, 3.468239927646798*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "\[DoublePrime]"], "[", "t", "]"}], "\[Equal]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        SubsuperscriptBox["\[Omega]", "0", "2"]}], 
       RowBox[{"x", "[", "t", "]"}]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Omega]", "0"], 
          RowBox[{"x", "[", "0", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["x", "\[Prime]"], "[", "0", "]"}]}], ")"}], "2"], 
      "\[Equal]", 
      SuperscriptBox[
       SubscriptBox["v", "0"], "2"]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Omega]", "0"], 
        RowBox[{"x", "[", "0", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]"], "[", "0", "]"}]}], "\[Equal]", 
      "0"}]}], "}"}], ",", " ", "x", ",", " ", "t"}], "]"}]], "Input"],

Cell[TextData[{
 " ",
 StyleBox["DSolve", "MR"],
 " also solves some boundary\[Hyphen]value problems (but it typically does \
not find all possible solutions). In the following example, these are ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["y", "k"], "(", "x", ")"}], "=", 
     RowBox[{"c", 
      RowBox[{"sin", "(", 
       RowBox[{"k", "x"}], ")"}]}]}], ",", 
    RowBox[{"k", "\[Epsilon]", "\"\<\[DoubleStruckCapitalZ]\>\""}]}], 
   TraditionalForm]], "InlineFormula"],
 ". The ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", "1"}], TraditionalForm]]],
 " solution is returned in the following example."
}], "Text",
 CellChangeTimes->{3.4682394300839243`*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "''"}], "[", "x", "]"}], "==", 
      RowBox[{"-", 
       RowBox[{"y", "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "==", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"y", "[", "Pi", "]"}], "==", "0"}]}], "}"}], ",", " ", 
   RowBox[{"y", "[", "x", "]"}], ",", " ", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.468239486134823*^9, 3.468239502296451*^9}}],

Cell[TextData[{
 ButtonBox["DSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/DSolve"],
 " should be able to solve any linear differential equation with constant \
coefficients, regardless of order, and many linear equations with nonconstant \
coefficients up to second order.  Many common special functions were \
originally defined as solutions to differential equations arising in diverse \
problems in physics, and hence those equations will usually be recognized.  "
}], "Text",
 CellChangeTimes->{{3.4682400757046585`*^9, 3.4682400993855004`*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "\[DoublePrime]"], "[", "x", "]"}], " ", "-", " ", 
     RowBox[{"x", " ", 
      RowBox[{"y", "[", "x", "]"}]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["z", "2"], " ", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]\[Prime]"], "[", "z", "]"}]}], "+", 
     RowBox[{"z", " ", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]",
        MultilineFunction->None], "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["z", "2"], "-", 
        SuperscriptBox["n", "2"]}], ")"}], " ", 
      RowBox[{"y", "[", "z", "]"}]}]}], "\[Equal]", "0"}], ",", "y", ",", 
   "z"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DSolve", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "\[Prime]\[Prime]"], "[", "z", "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox["n", 
         SuperscriptBox["z", "2"]]}], ")"}], " ", 
      RowBox[{"y", "[", "z", "]"}]}]}], "\[Equal]", "0"}], ",", "y", ",", 
   "z"}], "]"}]], "Input"],

Cell["\<\
However, many relatively simple differential equations cannot be solved in \
terms of named functions.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"DSolve", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "\[Prime]\[Prime]"], "[", "z", "]"}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "z", "]"}], " ", 
      RowBox[{"y", "[", "z", "]"}]}]}], "\[Equal]", "0"}], ",", "y", ",", 
   "z"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DSolve", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "\[Prime]\[Prime]"], "[", "z", "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox["n", 
         SuperscriptBox["z", "n"]]}], ")"}], " ", 
      RowBox[{"y", "[", "z", "]"}]}]}], "\[Equal]", "0"}], ",", "y", ",", 
   "z"}], "]"}]], "Input"],

Cell["\<\
Also, systems of coupled differential equations can be solved. \
\>", "Text",
 CellChangeTimes->{3.468240486705804*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "''"}], "[", "x", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"y", "[", "x", "]"}]}], "+", 
        RowBox[{
         RowBox[{"z", "'"}], "[", "x", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "'"}], "[", "x", "]"}], "\[Equal]", 
       RowBox[{"2", 
        RowBox[{"y", "[", "x", "]"}]}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "z"}], "}"}], ",", "x"}], "]"}], Cell[""]}]], "Input",
 CellChangeTimes->{{3.4682408830868998`*^9, 3.4682409336629925`*^9}, {
  3.4682409770934687`*^9, 3.4682409799482737`*^9}, {3.468241024938752*^9, 
  3.4682410510375986`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "x", "]"}], " ", "==", " ", 
       RowBox[{
        RowBox[{"z", "[", "x", "]"}], " ", "+", " ", 
        RowBox[{"3", " ", "x"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "'"}], "[", "x", "]"}], " ", "\[Equal]", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"y", "[", "x", "]"}]}], " ", "+", " ", 
        RowBox[{"2", " ", 
         RowBox[{"z", "[", "x", "]"}]}]}]}]}], "}"}], ",", "\n", "       ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "[", "x", "]"}], ",", " ", 
      RowBox[{"z", "[", "x", "]"}]}], "}"}], ",", " ", "x"}], "]"}], " ", "//", 
  RowBox[{
   RowBox[{"Short", "[", 
    RowBox[{"#", ",", "8"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.468240504864236*^9, 3.4682405072666397`*^9}, {
  3.468240544051504*^9, 3.468240601225605*^9}}],

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]", "=", 
     RowBox[{"Pi", "/", "3"}]}], "}"}], ",", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "x", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], 
          RowBox[{"y", "[", "x", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"z", "[", "x", "]"}]}], "+", "1"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"z", "'"}], "[", "x", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], 
          RowBox[{"y", "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], 
          RowBox[{"z", "[", "x", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"y", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"z", "[", "0", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "z"}], "}"}], ",", "x"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "[", "x", "]"}], ",", 
       RowBox[{"z", "[", "x", "]"}]}], "}"}], "/.", 
     RowBox[{"First", "[", "%", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "9"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4682423513778825`*^9, 3.468242360847099*^9}}],

Cell["Piecewise forcing functions:", "Text",
 CellChangeTimes->{{3.46824196891201*^9, 3.4682419761036234`*^9}}],

Cell[BoxData[{
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "x", "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Clip", "[", "x", "]"}], "^", "2"}], 
        RowBox[{"y", "[", "x", "]"}]}]}], "==", "0"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0.5"}]}], "}"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "x", "]"}], "/.", "%"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.468242021764903*^9, 3.4682421013874435`*^9}}],

Cell[BoxData[{
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "==", 
      RowBox[{"Piecewise", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "x", "]"}], "^", "2"}], ",", 
           RowBox[{"x", " ", ">", "2"}]}], "}"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "x", "]"}], "^", "2"}], "/", "3"}]}], "]"}]}], 
     ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], " ", "==", " ", "1"}]}], "}"}], ",", "y", 
   ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "x", "]"}], "/.", "%"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "7"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.46824212258788*^9, 3.468242128531491*^9}}],

Cell[CellGroupData[{

Cell["Excercise", "Subsubsection",
 CellChangeTimes->{{3.4682402305296574`*^9, 3.4682402319648595`*^9}}],

Cell[TextData[{
 "Solve ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["y", "\[Prime]"], " ", "+", " ", 
     RowBox[{"y", " ", 
      RowBox[{"tan", "(", "x", ")"}]}]}], " ", "=", " ", 
    RowBox[{"sin", "(", 
     RowBox[{"2", "x"}], ")"}]}], TraditionalForm]]],
 " given ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", "2"}], TraditionalForm]]],
 " when ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", "0"}], TraditionalForm]]],
 " and verify the solution."
}], "Text",
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Obtain the symbolic solution to a second-order linear differential equation \
with constant coefficients in the general form ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SuperscriptBox["y", "\[DoublePrime]"]}], " ", "+", " ", 
     RowBox[{"b", " ", 
      SuperscriptBox["y", "\[Prime]"]}], " ", "+", " ", 
     RowBox[{"c", " ", "y"}]}], " ", "=", " ", "0"}], TraditionalForm]]],
 " and interpret the solution."
}], "Text",
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Solve ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["y", "\[Prime]"], ")"}], "2"], "+", " ", "y"}], "=", 
    "a"}], TraditionalForm]]],
 " and verify the solution."
}], "Text",
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Solve ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["y", "\[Prime]"], "+", " ", 
     SuperscriptBox["y", "2"]}], "=", "a"}], TraditionalForm]]],
 " and verify the solution."
}], "Text",
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Plot the direction field of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[DifferentialD]", "y"}], "/", 
     RowBox[{"\[DifferentialD]", "x"}]}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]], "-", 
     RowBox[{"2", "y"}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " together with various solutions of the DE."
}], "Text",
 CellChangeTimes->{{3.4721906009300547`*^9, 3.472190674764984*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Graph the direction field associated with the DE ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[DifferentialD]", "y"}], 
    RowBox[{"\[DifferentialD]", "x"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "=",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"cos", " ", "y"}], " ", "-", " ", 
     RowBox[{"y", " ", "cos", " ", "x"}]}], 
    RowBox[{
     RowBox[{"x", " ", "sin", " ", "y"}], " ", "+", " ", 
     RowBox[{"sin", " ", "x"}], " ", "-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "together with some of its solutions."
}], "Text",
 CellChangeTimes->{{3.472190686246604*^9, 3.4721907428903036`*^9}, {
  3.47219077505756*^9, 3.472190778926367*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbolic Solution to PDE's", "Subsection",
 CellChangeTimes->{{3.4698546507639523`*^9, 3.4698546577439613`*^9}}],

Cell[TextData[{
 "A partial differential equation (PDE) is a relationship between an unknown \
function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "(", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["x", "n"]}], ")"}], TraditionalForm]], "InlineMath"],
 " and its derivatives with respect to the variables ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], ",", 
    SubscriptBox["x", "2"], ",", "\[Ellipsis]", ",", 
    SubscriptBox["x", "n"]}], TraditionalForm]], "InlineMath"],
 ". "
}], "Text",
 CellChangeTimes->{3.46985467077398*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"equation1", "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"u", "(", 
         RowBox[{"x", ",", "y"}], ")"}]}], 
       RowBox[{"\[PartialD]", "x"}],
       MultilineFunction->None], "+", 
      RowBox[{"x", " ", 
       FractionBox[
        RowBox[{"\[PartialD]", 
         RowBox[{"u", "(", 
          RowBox[{"x", ",", "y"}], ")"}]}], 
        RowBox[{"\[PartialD]", "y"}],
        MultilineFunction->None]}]}], "\[LongEqual]", 
     RowBox[{"sin", "(", "x", ")"}]}]}], ";"}], TraditionalForm]], "Input"],

Cell[TextData[{
 "PDEs occur naturally in applications; they model the rate of change of a \
physical quantity with respect to both space variables and time variables. At \
this stage of development, ",
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " typically only works with PDEs having two independent variables."
}], "Text",
 CellChangeTimes->{3.4698547017940235`*^9}],

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{
   StyleBox[
    RowBox[{"u", "/.", 
     RowBox[{
      RowBox[{"DSolve", "[", 
       RowBox[{"equation1", ",", " ", "u", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}],
    FontSlant->"Plain"], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "[", "t_", "]"}], "\[Rule]", 
    "t"}]}]}]], "Input"],

Cell["Verifying the solution", "Text",
 CellChangeTimes->{{3.4698548114161777`*^9, 3.469854814276182*^9}}],

Cell[BoxData[
 RowBox[{"equation1", " ", "/.", 
  RowBox[{"{", 
   RowBox[{"u", "\[Rule]", " ", "sol"}], "}"}]}]], "Input"],

Cell[TextData[{
 "Recall that the general solutions to PDEs involve arbitrary ",
 StyleBox["functions",
  FontSlant->"Italic"],
 " rather than arbitrary ",
 StyleBox["constants",
  FontSlant->"Italic"],
 ". The reason for this can be seen from the following example."
}], "Text",
 CellChangeTimes->{3.469854860046246*^9}],

Cell[TextData[{
 "The partial derivative with respect to ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 StyleBox[" ",
  FontSlant->"Italic"],
 "does not appear in this example, so an arbitrary function ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    ButtonBox["C",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/C"], "[", "1", "]"}], "[", 
   StyleBox["y", "TI"], "]"}]], "InlineFormula"],
 " can be added to the solution, since the partial derivative of ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    ButtonBox["C",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/C"], "[", "1", "]"}], "[", 
   StyleBox["y", "TI"], "]"}]], "InlineFormula"],
 " with respect to",
 StyleBox[" ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 StyleBox[" ",
  FontSlant->"Italic"],
 "is 0."
}], "Text",
 CellChangeTimes->{3.4698548655462537`*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "\[Equal]", "1"}], 
   ",", " ", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input"],

Cell["\<\
The general solution of the 1D wave equation also contains arbitrary \
functions.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", " ", "t"}], "]"}], ",", " ", "x", ",", " ", "x"}], 
     "]"}], " ", "==", " ", 
    RowBox[{
     RowBox[{"\[Alpha]", "^", "2"}], " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", " ", "t"}], "]"}], ",", " ", "t", ",", " ", "t"}], 
      "]"}]}]}], ",", " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"x", ",", " ", "t"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", "t"}], "}"}]}], "]"}]], "Input"],

Cell[TextData[{
 "The ",
 StyleBox[ButtonBox["transport equation",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DSolveIntroductionToPDEs#27918"],
  FontSlant->"Italic"],
 " is a good example of a linear first-order homogeneous PDE with constant \
coefficients. "
}], "Text",
 CellChangeTimes->{3.4698549303283453`*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "+", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}], "\[LongEqual]", 
    "0"}], ",", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input"],

Cell[TextData[{
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " can find the general solution for a restricted type of homogeneous linear \
second-order PDEs; namely, equations of the form"
}], "Text",
 CellChangeTimes->{3.4722040311911335`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"a", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "2"], "u"}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["x", "2"]}]]}], "+", 
    RowBox[{"b", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "2"], "u"}], 
      RowBox[{
       RowBox[{"\[PartialD]", "x"}], "\[ThinSpace]", 
       RowBox[{"\[PartialD]", "y"}]}]]}], "+", 
    RowBox[{"c", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "2"], "u"}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["y", "2"]}]]}]}], "=", "0."}], 
  TraditionalForm]], "DisplayFormula",
 CellID->10440],

Cell[TextData[{
 "Here ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]], "InlineMath"],
 ", and ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]], "InlineMath"],
 " are constants. Thus, ",
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " assumes that the equation has constant coefficients and a vanishing \
non-principal part."
}], "Text",
 CellChangeTimes->{3.472204064961194*^9}],

Cell[TextData[{
 "This finds the general solution of the ",
 ButtonBox["wave equation",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DSolveIntroductionToPDEs#27918"],
 ", a hyperbolic PDE. The constant ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]], "InlineMath"],
 " in the wave equation represents the speed of light and is set to 1 here \
for convenience."
}], "Text",
 CellChangeTimes->{3.469855105860593*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveEquation", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "\[Equal]", "0"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{"WaveEquation", " ", ",", " ", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x"}], "}"}]}], "]"}]], "Input"],

Cell[TextData[{
 "Here is the general solution for ",
 ButtonBox["Laplace\[CloseCurlyQuote]s equation",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DSolveIntroductionToPDEs#27918"],
 ", an elliptic PDE."
}], "Text",
 CellChangeTimes->{3.4722040762868137`*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "+", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", "y", ",", "y"}], "]"}]}], 
    "\[Equal]", "0"}], ",", "u", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4722034053023815`*^9, 3.472203551427838*^9}, {
   3.4722036968381414`*^9, 3.47220370158055*^9}, {3.472203838651593*^9, 
   3.472203839306794*^9}, 3.4722039015041037`*^9}],

Cell[TextData[{
 "This general solution contains two arbitrary functions, ",
 Cell[BoxData[
  RowBox[{
   ButtonBox["C",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/C"], "[", "1", "]"}]], "InlineFormula"],
 " and ",
 Cell[BoxData[
  RowBox[{
   ButtonBox["C",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/C"], "[", "2", "]"}]], "InlineFormula"],
 ". The arguments of these functions, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "+", 
    RowBox[{"\[ImaginaryI]", "x"}]}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "-", 
    RowBox[{"\[ImaginaryI]", "x"}]}], TraditionalForm]], "InlineMath"],
 ", indicate that the solution is constant along the imaginary straight line ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], "x"}], "+", "\[Alpha]"}]}], 
   TraditionalForm]], "InlineMath"],
 " when ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    ButtonBox["C",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/C"], "[", "2", "]"}], "\[Equal]", "0"}]], 
  "InlineFormula"],
 " and along ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", "x"}], "+", "\[Alpha]"}]}], TraditionalForm]], 
  "InlineMath"],
 " when ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    ButtonBox["C",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/C"], "[", "1", "]"}], "\[Equal]", "0"}]], 
  "InlineFormula"],
 " . These straight lines are called characteristic curves of the PDE. In \
general, elliptic PDEs have imaginary characteristic curves."
}], "Text",
 CellChangeTimes->{3.4722040934936438`*^9}],

Cell["\<\
To find a particular solution we replace the constant functions (in our case \
we take the exponential function:\
\>", "Text",
 CellChangeTimes->{{3.472204099593255*^9, 3.4722041533041487`*^9}}],

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{
   RowBox[{"%", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "[", "t__", "]"}], "\[Rule]", 
      RowBox[{"Exp", "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"C", "[", "2", "]"}], "[", "t__", "]"}], "\[Rule]", 
      RowBox[{"Exp", "[", "t", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.472203843097601*^9, 3.4722039088517165`*^9}}],

Cell["To verify, that this is actually a solution:", "Text",
 CellChangeTimes->{{3.4722041562057543`*^9, 3.4722041633973665`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "+", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "y", ",", "y"}], "]"}]}], 
   "\[Equal]", "0"}], "/.", "sol"}]], "Input",
 CellChangeTimes->{{3.472203932438958*^9, 3.472203936260965*^9}}],

Cell[TextData[{
 "As a last example we take a look at the ",
 StyleBox[ButtonBox["Burger's equation, ",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/DSolveIntroductionToPDEs#27918"],
  FontSlant->"Italic"],
 "which is an important example of a quasi-linear PDE. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{"u", "(", 
        RowBox[{"x", ",", "y"}], ")"}]}], 
      RowBox[{"\[PartialD]", "x"}]], "+", 
     RowBox[{
      RowBox[{"u", "(", 
       RowBox[{"x", ",", "y"}], ")"}], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"u", "(", 
         RowBox[{"x", ",", "y"}], ")"}]}], 
       RowBox[{"\[PartialD]", "y"}]]}]}], "\[LongEqual]", "0"}], 
   TraditionalForm]]],
 ". We will try to find a solution"
}], "Text",
 CellChangeTimes->{{3.47220470607552*^9, 3.472204753889604*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "+", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}]}], "\[Equal]", 
    "0"}], ",", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.47220470607552*^9, 3.472204772594841*^9}}],

Cell[TextData[{
 "The solution depends on the 2-dimensional function C[1]. We have to provide \
a function C[1] so that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " can solve the above output for u[x,y]. Let us assume a simple form of C[1]"
}], "Text",
 CellChangeTimes->{{3.47220480003529*^9, 3.4722048820134335`*^9}}],

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[Rule]", 
    RowBox[{"a", "-", 
     RowBox[{"2", "b"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.47220470607552*^9, 3.4722047853868637`*^9}}],

Cell[TextData[{
 "To verify that ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"2", "y"}], 
    RowBox[{"1", "+", 
     RowBox[{"2", "x", " "}]}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "actually is a solution we insert it into our initial equation:"
}], "Text",
 CellChangeTimes->{{3.4722049106082835`*^9, 3.4722049522371593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "+", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}]}], "\[Equal]", 
   "0"}], "/.", 
  RowBox[{"sol", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4722049014822674`*^9, 3.472204905054674*^9}}],

Cell["\<\
What happened here? Obviously, the solution only replaced one instance of \
u[x,y]. The differential operators have not been changed. Take a closer look \
at \
\>", "Text",
 CellChangeTimes->{{3.472204955559965*^9, 3.472205002625248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "/.", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{"2", " ", "y"}], 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "x"}]}]]}]}]], "Input",
 CellChangeTimes->{{3.4722050100040607`*^9, 3.472205017211273*^9}}],

Cell[TextData[{
 "Nothing happens. To understand why ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " does not apply the replacement rules we will use ",
 ButtonBox["Trace",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/Trace"],
 ":"
}], "Text",
 CellChangeTimes->{{3.472205024012885*^9, 3.472205056835343*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"x", ",", "y"}], "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "y"}], 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "x"}]}]]}]}], "//", "Trace"}]], "Input",
 CellChangeTimes->{{3.472205061468551*^9, 3.472205068753764*^9}, 
   3.472205105351428*^9}],

Cell["Look at the third output element ", "Text",
 CellChangeTimes->{{3.4722050809685855`*^9, 3.472205122917059*^9}}],

Cell[BoxData[
 RowBox[{"%", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4722050987994165`*^9, 3.47220510074942*^9}}],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " reformulates D[u[x,y],x] to ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["u", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y"}], "]"}]],
  CellChangeTimes->{{3.472205101311021*^9, 3.472205113182642*^9}}],
 " and then tries to replace any instance of u[x,y]. But syntactically there \
is no u[x,y] left. We have to prevent the reformulation of the differential \
before doeing the replacement:. This is done with ",
 ButtonBox["HoldForm",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/HoldForm"],
 ":"
}], "Text",
 CellChangeTimes->{{3.4722051297498713`*^9, 3.4722052426472692`*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"HoldForm", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4722052244888372`*^9, 3.4722052252220387`*^9}}],

Cell["Finally, we can verify our solution", "Text",
 CellChangeTimes->{{3.4722052628181047`*^9, 3.4722052677789135`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HoldForm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", "x"}], "]"}], "+", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"x", ",", "y"}], "]"}], 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "y"}], "]"}]}]}], "\[Equal]", 
     "0"}], "]"}], "/.", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", "ReleaseHold"}]], "Input",
 CellChangeTimes->{{3.47220470607552*^9, 3.4722047853868637`*^9}, {
  3.4722052599632998`*^9, 3.472205260524901*^9}}],

Cell[CellGroupData[{

Cell["Excercises", "Subsubsection",
 CellChangeTimes->{{3.472193888375086*^9, 3.4721938898414884`*^9}}],

Cell[TextData[{
 "Show that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"u", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}]}], "=", 
    RowBox[{
     SuperscriptBox["y", "2"], "-", 
     SuperscriptBox["x", "2"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"u", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}]}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "y"], "sin", " ", "x"}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are solutions to Laplace's equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["u", "xx"], "+", 
     SubscriptBox["u", "yy"]}], "=", "0"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.472193892774294*^9, 3.472193954737602*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Find a solution of: x ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", "x"], "=", 
    SubscriptBox["u", "y"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ". "
}], "Text",
 CellChangeTimes->{{3.472194079210221*^9, 3.4721941175706882`*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "Find the general solution to the transport equation, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", 
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"y", "(", 
         RowBox[{"x", ",", "t"}], ")"}]}], 
       RowBox[{"\[PartialD]", "x"}],
       MultilineFunction->None]}], "+", 
     FractionBox[
      RowBox[{"\[PartialD]", 
       RowBox[{"y", "(", 
        RowBox[{"x", ",", "t"}], ")"}]}], 
      RowBox[{"\[PartialD]", "t"}],
      MultilineFunction->None]}], "\[LongEqual]", "0"}], TraditionalForm]], 
  "InlineMath"],
 "."
}], "Text",
 CellChangeTimes->{{3.4721944569648843`*^9, 3.4721944682749043`*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbolic Solution to Differential-Algebraic Equations (DAEs)", \
"Subsection",
 CellChangeTimes->{{3.469855914391748*^9, 3.469855925891764*^9}}],

Cell["\<\
The systems of equations that govern certain phenomena (in electrical \
circuits, chemical kinetics, etc.) contain a combination of differential \
equations and algebraic equations. The differential equations are responsible \
for the dynamical evolution of the system, while the algebraic equations \
serve to constrain the solutions to certain manifolds.\
\>", "Text",
 CellChangeTimes->{3.4698559397617836`*^9}],

Cell[TextData[{
 "Here is a simple example of a DAE. The first equation is an ODE for the \
function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "[", "t", "]"}], TraditionalForm]], "InlineMath"],
 ", while the second equation constrains the functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "[", "t", "]"}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "[", "t", "]"}], TraditionalForm]], "InlineMath"],
 " to lie in a submanifold (a straight line) in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], TraditionalForm]], "InlineMath"],
 " space. "
}], "Text",
 CellChangeTimes->{3.4698559482017956`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dae", " ", "=", 
   StyleBox[
    RowBox[{" ", 
     StyleBox[" ",
      FormatType->StandardForm]}]], 
   RowBox[{
    StyleBox["{",
     FormatType->StandardForm], 
    RowBox[{
     RowBox[{
      StyleBox[
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], " ", "-", " ", 
        RowBox[{"y", "[", "t", "]"}]}],
       FormatType->StandardForm], 
      StyleBox["\[Equal]",
       FormatType->StandardForm], "0"}], 
     StyleBox[",",
      FormatType->StandardForm], 
     StyleBox[" ",
      FormatType->StandardForm], 
     StyleBox[
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], " ", "+", " ", 
        RowBox[{"y", "[", "t", "]"}]}], " ", "==", " ", "0"}],
      FormatType->StandardForm]}], 
    StyleBox["}",
     FormatType->StandardForm]}]}], 
  StyleBox[";",
   FormatType->StandardForm]}]], "Input",
 CellChangeTimes->{3.469856068785968*^9}],

Cell["\<\
Linear DAE's are defined as systems of equations of the following type.\
\>", "Text",
 CellChangeTimes->{{3.469855992711858*^9, 3.469856000151868*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"A", ".", 
     RowBox[{
      SuperscriptBox["x", "\[Prime]"], "(", "t", ")"}]}], "+", 
    RowBox[{"B", ".", 
     RowBox[{"x", "(", "t", ")"}]}]}], "\[LongEqual]", "F"}], 
  TraditionalForm]], "Text",
 CellTags->"b:3.0",
 CellID->6021],

Cell[TextData[{
 Cell[BoxData[
  ButtonBox["DSolve",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/DSolve"]], "InlineFormula"],
 " can find the solutions to all DAEs in which the entries of the matrices ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]], "InlineMath"],
 " are constants. Such DAEs are said to have constant coefficients."
}], "Text",
 CellChangeTimes->{3.4698560246959057`*^9}],

Cell["\<\
It is important to realize that the initial values for a DAE must be \
prescribed carefully to guarantee a solution for the problem. This can be \
seen by considering the following system of equations.\
\>", "Text",
 CellChangeTimes->{3.4698560335059185`*^9}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{"dae", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", " ", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{3.469856078825982*^9}],

Cell["This verifies the solution.", "Text",
 CellTags->"b:3.1",
 CellID->28289],

Cell[BoxData[
 RowBox[{
  RowBox[{"dae", "/.", "sol"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{3.469856095217119*^9},
 CellTags->"b:3.1",
 CellID->15944]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbolic Solution to Difference Equations", "Subsection",
 CellChangeTimes->{{3.4698808450125084`*^9, 3.469880856852525*^9}}],

Cell[TextData[{
 "Required Reading:\n\n",
 ButtonBox["Solving Recurrence Equations",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/SolvingRecurrenceEquations"]
}], "Text",
 CellChangeTimes->{{3.4698809506346703`*^9, 3.4698809635946913`*^9}}],

Cell[TextData[{
 "The discrete analog of differential equations are difference (recurrence) \
equations.  The ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " function to solve difference equations is ",
 ButtonBox["RSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/RSolve"],
 "."
}], "Text",
 CellChangeTimes->{{3.469880859412529*^9, 3.469880879342557*^9}}],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   ButtonBox["RSolve",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/RSolve"], "[", 
   RowBox[{
    StyleBox["eqn", "TI"], ",", 
    RowBox[{
     StyleBox["a", "TI"], "[", 
     StyleBox["n", "TI"], "]"}], ",", 
    StyleBox["n", "TI"]}], "]"}]], "InlineFormula"],
 " ",
 "solves a recurrence equation for ",
 Cell[BoxData[
  RowBox[{
   StyleBox["a", "TI"], "[", 
   StyleBox["n", "TI"], "]"}]], "InlineFormula"],
 "."
}], "Text",
 CellChangeTimes->{{3.4698808969785852`*^9, 3.469880903328594*^9}}],

Cell["To start with, here is a simple linear difference equations:", "Text",
 CellChangeTimes->{{3.469881011278761*^9, 3.469881027008783*^9}}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"n", " ", "+", " ", "1"}], "]"}], " ", "==", " ", 
    RowBox[{
     RowBox[{"u", "[", "n", "]"}], " ", "-", " ", 
     RowBox[{"u", "[", 
      RowBox[{"n", " ", "-", " ", "1"}], "]"}]}]}], ",", " ", 
   RowBox[{"u", "[", "n", "]"}], ",", " ", "n"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]", "[", "k", "]"}], " ", 
       RowBox[{"u", "[", 
        RowBox[{"n", " ", "+", " ", "k"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "0", ",", " ", "4"}], "}"}]}], "]"}], " ", "==",
     " ", "0"}], ",", " ", 
   RowBox[{"u", "[", "n", "]"}], ",", " ", "n"}], "]"}]], "Input"],

Cell["\<\
The simplest possible linear difference equation with non-constant \
coefficients is\
\>", "Text",
 CellChangeTimes->{{3.469881199935028*^9, 3.4698812162450514`*^9}}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", 
     RowBox[{"n", " ", "+", " ", "1"}], "]"}], " ", "==", " ", 
    RowBox[{"n", " ", 
     RowBox[{"\[CapitalGamma]", "[", "n", "]"}]}]}], ",", " ", 
   RowBox[{"\[CapitalGamma]", "[", "n", "]"}], ",", " ", "n"}], 
  "]"}]], "Input"],

Cell["\<\
When we add an initial condition the result involves the familiar Gamma \
function\
\>", "Text",
 CellChangeTimes->{{3.4698812413550863`*^9, 3.4698812485750966`*^9}, {
  3.469881288737154*^9, 3.469881305947178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "\[Equal]", 
       RowBox[{"n", " ", 
        RowBox[{"\[CapitalGamma]", "[", "n", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", "1", "]"}], "\[Equal]", "1"}]}], "}"}],
     ",", 
    RowBox[{"\[CapitalGamma]", "[", "n", "]"}], ",", "n"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.46988123664508*^9, 3.469881237305081*^9}, {
  3.4698813103771844`*^9, 3.4698813340072174`*^9}}],

Cell["A third-order constant coefficient equation: ", "Text",
 CellChangeTimes->{3.469882164342589*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"n", "+", "3"}], "]"}], "\[Equal]", 
    RowBox[{"2", 
     RowBox[{"a", "[", "n", "]"}]}]}], ",", " ", "a", ",", "n"}], 
  "]"}]], "Input"],

Cell["Initial value conditions: ", "Text",
 CellChangeTimes->{3.4698821528145633`*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"n", "+", "3"}], "]"}], "\[Equal]", 
      RowBox[{"2", 
       RowBox[{"a", "[", "n", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "\[Equal]", "2"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], "\[Equal]", 
      RowBox[{"-", "1"}]}]}], "}"}], ",", " ", "a", ",", "n"}], 
  "]"}]], "Input"],

Cell["Plot the solution:", "Text",
 CellChangeTimes->{3.469882177440632*^9}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "n", "]"}], "/.", 
      RowBox[{"First", "[", "%", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "15"}], "}"}]}], "]"}], ",", 
   RowBox[{"Filling", "\[Rule]", "Axis"}]}], "]"}]], "Input"],

Cell[TextData[{
 "Of course, ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " can also solve inhomogeneous difference equations. Here is the \
corresponding inhomogeneous case with a constant right hand side term"
}], "Text",
 CellChangeTimes->{{3.4698813598272533`*^9, 3.4698814139573293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "-", 
        RowBox[{"n", " ", 
         RowBox[{"\[CapitalGamma]", "[", "n", "]"}]}]}], "\[Equal]", "A"}], 
      ",", 
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", "1", "]"}], "\[Equal]", "1"}]}], "}"}],
     ",", 
    RowBox[{"\[CapitalGamma]", "[", "n", "]"}], ",", "n"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{3.4698814646774015`*^9}],

Cell["\<\
When the right hand side contains a function of n, the solution will contain \
a summation with automatically generated dummy variables K$n.\
\>", "Text",
 CellChangeTimes->{{3.4698814748574157`*^9, 3.46988151345747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalGamma]", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "-", 
        RowBox[{"n", " ", 
         RowBox[{"\[CapitalGamma]", "[", "n", "]"}]}]}], "\[Equal]", 
       RowBox[{"A", "[", "n", "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", "1", "]"}], "\[Equal]", "1"}]}], "}"}],
     ",", 
    RowBox[{"\[CapitalGamma]", "[", "n", "]"}], ",", "n"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.469881426497348*^9, 3.469881430677354*^9}}],

Cell["\<\
Here is another example with an unspecified coefficient on the right hand side\
\>", "Text",
 CellChangeTimes->{{3.469881628091633*^9, 3.46988165479167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"n", " ", "+", " ", "1"}], "]"}], " ", "==", " ", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "n", "]"}], " ", 
       RowBox[{"\[CapitalPsi]", "[", "n", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"\[CapitalPsi]", "[", "n", "]"}], ",", " ", "n"}], "]"}], 
  " "}]], "Input"],

Cell["Here is the simplest possible nonlinear difference equation.", "Text",
 CellChangeTimes->{3.469881664741684*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"n", " ", "+", " ", "1"}], "]"}], " ", "==", " ", 
    RowBox[{
     RowBox[{"u", "[", "n", "]"}], "^", "2"}]}], ",", " ", 
   RowBox[{"u", "[", "n", "]"}], ",", " ", "n"}], "]"}]], "Input"],

Cell["Linear system with constant coefficients:", "Text",
 CellChangeTimes->{3.4698818763619943`*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "+", 
       RowBox[{"z", "[", "n", "]"}]}], "\[Equal]", "3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", "n", "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"z", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}]}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "[", "n", "]"}], ",", 
     RowBox[{"z", "[", "n", "]"}]}], "}"}], ",", " ", "n"}], "]"}]], "Input"],

Cell["With boundary conditions:", "Text",
 CellChangeTimes->{3.469881891072015*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "+", 
       RowBox[{"z", "[", "n", "]"}]}], "\[Equal]", "3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "[", "n", "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"z", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}]}], "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "5"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "0", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "z"}], "}"}], ",", " ", "n"}], "]"}]], "Input"],

Cell["Plot their solution:", "Text",
 CellChangeTimes->{3.469881900442028*^9}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", " ", "@", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y", "[", "n", "]"}], ",", 
         RowBox[{"z", "[", "n", "]"}]}], "}"}], "/.", 
       RowBox[{"First", "[", "%", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", "15"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"Filling", "\[Rule]", "Axis"}]}], "]"}]], "Input"],

Cell[TextData[{
 "This models the amount ",
 Cell[BoxData[
  RowBox[{
   StyleBox["a", "TI"], "[", 
   StyleBox["n", "TI"], "]"}]], "InlineFormula"],
 " at year ",
 Cell[BoxData[
  StyleBox["n", "TI"]], "InlineFormula"],
 " when the interest ",
 Cell[BoxData[
  StyleBox["r", "TI"]], "InlineFormula"],
 " is paid on the principal ",
 Cell[BoxData[
  StyleBox["p", "TI"]], "InlineFormula"],
 " only:"
}], "Text",
 CellChangeTimes->{3.4698820082241974`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"a", "[", "n", "]"}], "+", 
        RowBox[{"r", " ", "p"}]}]}], ",", 
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], "\[Equal]", "p"}]}], "}"}], ",", 
    RowBox[{"a", "[", "n", "]"}], ",", "n"}], "]"}], "//", 
  "Factor"}]], "Input"],

Cell[TextData[{
 "Here the interest is paid on the current amount ",
 Cell[BoxData[
  RowBox[{
   StyleBox["a", "TI"], "[", 
   StyleBox["n", "TI"], "]"}]], "InlineFormula"],
 ", i.e. compound interest:"
}], "Text",
 CellChangeTimes->{3.4698820221662245`*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"n", "+", "1"}], "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], 
       RowBox[{"a", "[", "n", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "\[Equal]", "p"}]}], "}"}], ",", 
   RowBox[{"a", "[", "n", "]"}], ",", "n"}], "]"}]], "Input"],

Cell[TextData[{
 "Here ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"a", "[", "n", "]"}], "TI"]], "InlineFormula"],
 " is the number of ways to tile a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "3"}], TraditionalForm]], "InlineMath"],
 " space with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "1"}], TraditionalForm]], "InlineMath"],
 " tiles: "
}], "Text",
 CellChangeTimes->{3.469882051436296*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"n", "+", "4"}], "]"}], "-", 
       RowBox[{"4", 
        RowBox[{"a", "[", 
         RowBox[{"n", "+", "2"}], "]"}]}], "+", 
       RowBox[{"a", "[", "n", "]"}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], "\[Equal]", "3"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], "\[Equal]", "11"}]}], "}"}], ",", "a", 
   ",", "n"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"a", "[", "n", "]"}], "/.", 
      RowBox[{"First", "[", "%", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "2", ",", "20", ",", "2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input"],

Cell[TextData[{
 "Another class of recurrence equations that is solved by ",
 StyleBox["RSolve", "MR"],
 " are ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]]],
 "\[Hyphen]difference equations. Instead of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "+", "k"}], TraditionalForm]]],
 ", one has the multiplicative structure ",
 Cell[BoxData[
  FormBox[
   RowBox[{"q", " ", "n"}], TraditionalForm]]],
 ". Here are two simple examples of such a ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]]],
 "\[Hyphen]difference equation."
}], "Text",
 CellChangeTimes->{3.469881711853753*^9}],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"q", " ", "n"}], "]"}], "\[Equal]", 
    RowBox[{"2", 
     RowBox[{"a", "[", "n", "]"}]}]}], ",", 
   RowBox[{"a", "[", "n", "]"}], ",", "n"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "n", "]"}], "\[Equal]", 
      RowBox[{"2", 
       RowBox[{"a", "[", 
        RowBox[{"n", "/", "q"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"a", "[", "n", "]"}], ",", "n"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"q", " ", "n"}], "]"}], " ", "==", " ", 
    RowBox[{
     RowBox[{"u", "[", "n", "]"}], " ", "-", " ", 
     RowBox[{"u", "[", 
      RowBox[{"n", "/", "q"}], "]"}]}]}], ",", " ", 
   RowBox[{"u", "[", "n", "]"}], ",", " ", "n"}], "]"}]], "Input"],

Cell["\<\
Note, that by replacing the derivatives in a differential equationsby finite \
differences we find the related difference equation \
\[PartialD]y/\[PartialD]x->u(n+1)-u(n). Hence, the ODE y'(x)-y(x)=0 \
translates to u(n+1)-2u(n)=0. \
\>", "Text",
 CellChangeTimes->{{3.472231322650288*^9, 3.472231377562807*^9}, {
  3.4722314270941744`*^9, 3.47223149725447*^9}, {3.4722319722800226`*^9, 
  3.4722320199393654`*^9}, {3.4722320523790226`*^9, 3.4722321282788568`*^9}}],

Cell[BoxData[{
 RowBox[{"DSolve", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", "x", "]"}], " ", "-", 
     RowBox[{"y", "[", "x", "]"}]}], "==", " ", "0"}], ",", "y", ",", " ", 
   "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"u", "[", "n", "]"}]}], "+", 
     RowBox[{"u", "[", 
      RowBox[{"1", "+", "n"}], "]"}]}], "\[Equal]", "0"}], ",", 
   RowBox[{"u", "[", "n", "]"}], ",", "n"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472232103497753*^9, 3.4722321099402666`*^9}}],

Cell[TextData[{
 "Generally, the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "-order forward, backward, and central differences are respectively given by \
(h\[Rule]1):"
}], "Text",
 CellChangeTimes->{{3.4722322040163794`*^9, 3.472232264345031*^9}, {
  3.472232483326056*^9, 3.47223249603219*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[CapitalDelta]", "h", "n"], "[", "f", "]"}], 
     RowBox[{"(", "x", ")"}]}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "0"}], "n"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "i"], 
      RowBox[{"(", GridBox[{
         {"n"},
         {"i"}
        }], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{"x", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "i"}], ")"}], "h"}]}], ")"}]}]}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Del]", "h", "n"], 
      RowBox[{"[", "f", "]"}]}], 
     RowBox[{"(", "x", ")"}]}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "0"}], "n"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "i"], 
      RowBox[{"(", GridBox[{
         {"n"},
         {"i"}
        }], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{"x", "-", 
        RowBox[{"i", " ", "h"}]}], ")"}]}]}]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Delta]", "h", "n"], "[", "f", "]"}], 
     RowBox[{"(", "x", ")"}]}], "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "0"}], "n"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "i"], 
      RowBox[{"(", GridBox[{
         {"n"},
         {"i"}
        }], ")"}], 
      RowBox[{"f", "(", 
       RowBox[{"x", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["n", "2"], "-", "i"}], ")"}], "h"}]}], ")"}]}]}]}], 
   TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.472232288483379*^9, 3.472232371647146*^9}, {
  3.472232438275256*^9, 3.4722324662722764`*^9}}],

Cell[CellGroupData[{

Cell["Excercises", "Subsubsection",
 CellChangeTimes->{{3.472205475384078*^9, 3.4722054768816805`*^9}}],

Cell["Solve the recurrence relation a(n+1)-2a(n)=1.", "Text",
 CellChangeTimes->{{3.472205479190485*^9, 3.472205503666928*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[TextData[{
 "The factorial can be understood as a recurrence relation of the form \
a(n+1)=n a(n). Use ",
 ButtonBox["RSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/RSolve"],
 " to find a generla solution "
}], "Text",
 CellChangeTimes->{{3.472205758056575*^9, 3.4722058069626603`*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell["\<\
Find the recurrence relation that is related to the differential equation x \
y''''[x]+5y'''[x]==24.\
\>", "Text",
 CellChangeTimes->{{3.472205479190485*^9, 3.472205503666928*^9}, {
  3.4722325243258114`*^9, 3.472232571586318*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variational Methods", "Subsection",
 CellChangeTimes->{{3.4698823219869676`*^9, 3.469882324736972*^9}}],

Cell[TextData[{
 "Required Reading:\n\n",
 ButtonBox["Variational Methods Package\n",
  BaseStyle->"Link",
  ButtonData->"paclet:VariationalMethods/guide/VariationalMethodsPackage"],
 ButtonBox["Variational Methods",
  BaseStyle->"Link",
  ButtonData->"paclet:VariationalMethods/tutorial/VariationalMethods"]
}], "Text",
 CellChangeTimes->{{3.4698824054570932`*^9, 3.4698824510571575`*^9}}],

Cell[TextData[{
 "The package ",
 ButtonBox["VariationalMethods`",
  BaseStyle->"Link",
  ButtonData->"paclet:VariationalMethods/tutorial/VariationalMethods"],
 "  implements the calculation of variational derivatives of integrals and \
the associated Euler\[Hyphen]Lagrange equation (for an introduction to \
variational calculations"
}], "Text",
 CellChangeTimes->{
  3.469882334396985*^9, {3.469882371107045*^9, 3.469882389317071*^9}}],

Cell[TextData[{
 "The basic problem of the calculus of variations is to determine the \
function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "(", "x", ")"}], TraditionalForm]], "InlineMath"],
 " that extremizes a functional ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      SubscriptBox["x", 
       StyleBox["min",
        FontSlant->"Italic"]], 
      SubscriptBox["x", 
       StyleBox["max",
        FontSlant->"Italic"]]], 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"u", 
         RowBox[{"(", "x", ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["u", "\[Prime]"], 
         RowBox[{"(", "x", ")"}]}], ",", "x"}], "]"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], TraditionalForm]], 
  "InlineMath"],
 ". In general, there can be more than one independent variable and the \
integrand ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 " can depend on several functions and their higher derivatives. "
}], "Text",
 CellChangeTimes->{3.4698824768871937`*^9}],

Cell[TextData[{
 "The extremal functions are solutions of the Euler(\[Dash]Lagrange) \
equations that are obtained by setting the first variational derivatives of \
the functional ",
 Cell[BoxData[
  StyleBox["F", "TI"]], "InlineFormula"],
 " with respect to each function equal to zero. Since many ordinary and \
partial differential equations that occur in physics and engineering can be \
derived as the Euler equations for appropriate functionals, variational \
methods are of general utility. "
}], "Text",
 CellChangeTimes->{3.469882518499253*^9}],

Cell["This loads the package. ", "Text",
 CellChangeTimes->{3.469882504319233*^9}],

Cell[BoxData[
 RowBox[{"<<", "VariationalMethods`"}]], "Input"],

Cell[TextData[{
 Cell[BoxData[
  ButtonBox["VariationalD",
   BaseStyle->"Link",
   ButtonData->"paclet:VariationalMethods/ref/VariationalD"]], 
  "InlineFormula"],
 " gives the first variational derivatives of a functional ",
 Cell[BoxData[
  StyleBox["F", "TI"]], "InlineFormula"],
 " defined by the integrand ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 ". ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 " may depend on several functions ",
 Cell[BoxData[
  RowBox[{
   StyleBox["u", "TI"], ",", 
   StyleBox["v", "TI"], ",", 
   StyleBox["w", "TI"], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula"],
 "; their derivatives of arbitrary order; and variables ",
 Cell[BoxData[
  RowBox[{
   StyleBox["x", "TI"], ",", 
   StyleBox["y", "TI"], ",", 
   StyleBox["z", "TI"], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula"],
 "\[ThinSpace]. ",
 Cell[BoxData[
  ButtonBox["EulerEquations",
   BaseStyle->"Link",
   ButtonData->"paclet:VariationalMethods/ref/EulerEquations"]], 
  "InlineFormula"],
 " returns the Euler(\[Dash]Lagrange) equations given the integrand ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 ". Again ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 " may depend on several functions ",
 Cell[BoxData[
  RowBox[{
   StyleBox["u", "TI"], ",", 
   StyleBox["v", "TI"], ",", 
   StyleBox["w", "TI"], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula"],
 "; their derivatives of arbitrary order; and variables ",
 Cell[BoxData[
  RowBox[{
   StyleBox["x", "TI"], ",", 
   StyleBox["y", "TI"], ",", 
   RowBox[{
    StyleBox["z", "TI"], 
    StyleBox[" ", "TI"], 
    StyleBox["\[Ellipsis]", "TR"]}]}]], "InlineFormula"],
 "\[ThinSpace]. "
}], "Text",
 CellChangeTimes->{3.469882551039298*^9}],

Cell["Here is a well\[Hyphen]known example. ", "Text",
 CellChangeTimes->{3.469882563409316*^9}],

Cell[BoxData[
 RowBox[{"VariationalD", "[", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", " ", "-", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "x", "]"}], "^", "2"}]}], "]"}], ",", " ", 
   RowBox[{"y", "[", "x", "]"}], ",", " ", "x"}], "]"}]], "Input"],

Cell[TextData[{
 "This is the first variational derivative of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      SubscriptBox["x", 
       StyleBox["min",
        FontSlant->"Italic"]], 
      SubscriptBox["x", 
       StyleBox["max",
        FontSlant->"Italic"]]], 
     RowBox[{
      RowBox[{"y", "(", "x", ")"}], 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["y", "\[Prime]"], 
        SuperscriptBox[
         RowBox[{"(", "x", ")"}], "2"]}]], 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], TraditionalForm]], 
  "InlineMath"],
 ". "
}], "Text",
 CellChangeTimes->{3.469882574189331*^9}],

Cell[BoxData[
 RowBox[{"VariationalD", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "[", "x", "]"}], " ", 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"]}]]}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]], "Input"],

Cell[TextData[{
 ButtonBox["EulerEquations[f,u[x],x]",
  BaseStyle->"Link",
  ButtonData->"paclet:VariationalMethods/ref/EulerEquations"],
 "returns the Euler\[Dash]Lagrange differential equation obeyed by ",
 Cell[BoxData[
  RowBox[{
   StyleBox["u", "TI"], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula"],
 " derived from the functional ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 ", where ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 " depends on the function ",
 Cell[BoxData[
  RowBox[{
   StyleBox["u", "TI"], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula"],
 " and its derivatives as well as the independent variable ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 "."
}], "Text",
 CellChangeTimes->{{3.469882607995388*^9, 3.4698826310754204`*^9}}],

Cell[TextData[{
 "A simple pendulum has the Lagrangian ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "m", " ", 
     SuperscriptBox["r", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Theta]", "."], "2"]}], "+", 
    RowBox[{"m", " ", "g", " ", "r", " ", 
     RowBox[{"cos", "(", "\[Theta]", ")"}]}]}], TraditionalForm]], 
  "InlineMath"],
 ":"
}], "Text",
 CellChangeTimes->{3.4698826910095067`*^9}],

Cell[BoxData[
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "m", " ", 
     SuperscriptBox["r", "2"], 
     SuperscriptBox[
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "2"]}], "+", 
    RowBox[{"m", " ", "g", " ", "r", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ",", 
   RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]], "Input"],

Cell[TextData[{
 "The solution to the pendulum equation can be expressed using the function ",
 Cell[BoxData[
  ButtonBox["JacobiAmplitude",
   BaseStyle->"Link",
   ButtonData->"paclet:ref/JacobiAmplitude"]], "InlineFormula"],
 ":"
}], "Text",
 CellChangeTimes->{3.4698827075315313`*^9}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{"%", ",", 
   RowBox[{"\[Theta]", "[", "t", "]"}], ",", "t"}], "]"}]], "Input"],

Cell["\<\
The next input gives the equation of motion for a damped nonlinear 1D \
oscillator \
\>", "Text",
 CellChangeTimes->{3.469882734891569*^9}],

Cell[BoxData[
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"\[Mu]", " ", "t"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], "^", "2"}], "/", "2"}], " ", 
      "+", " ", 
      RowBox[{
       RowBox[{"a", "/", "2"}], " ", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], "^", "2"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"b", "/", 
        RowBox[{"(", 
         RowBox[{"n", " ", "+", " ", "1"}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], "^", "n"}]}]}], ")"}]}], ",", "\n", 
   "               ", 
   RowBox[{"{", 
    RowBox[{"x", "[", "t", "]"}], "}"}], ",", " ", "t"}], "]"}]], "Input"],

Cell["\<\
Here are the Newton equations of motion for a 2D anharmonic oscillator. \
\>", "Text",
 CellChangeTimes->{3.469949813490037*^9}],

Cell[BoxData[
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"m", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", "+",
     " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "^", "4"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", 
       RowBox[{"y", "[", "t", "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], "^", "4"}]}], ")"}]}], ",", "\n", 
   "               ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], ",", " ", 
     RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", " ", "t"}], "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "'"}], "[", "x", "]"}], ",", 
     RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"y", "[", "x", "]"}], ",", "x"}], "]"}]}], "Input",
 CellChangeTimes->{{3.469882814661681*^9, 3.469882852523735*^9}}],

Cell["\<\
The Lagrangian for a vibrating string yields the classical wave equation:\
\>", "Text",
 CellChangeTimes->{3.469882892433791*^9}],

Cell[BoxData[
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "\[Rho]", " ", 
     SuperscriptBox[
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "2"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], "\[Tau]", " ", 
     SuperscriptBox[
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "2"]}]}], ",", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "t"}], "}"}]}], "]"}]], "Input"],

Cell[TextData[{
 "The default coordinate system is set to ",
 Cell[BoxData[
  ButtonBox["Cartesian",
   BaseStyle->"Link",
   ButtonData->"paclet:VectorAnalysis/ref/Cartesian"]], "InlineFormula"],
 " and the coordinates are set to ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 ", ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula"],
 ", and ",
 Cell[BoxData[
  StyleBox["z", "TI"]], "InlineFormula"],
 ". "
}], "Text",
 CellChangeTimes->{{3.469882962147891*^9, 3.4698829673078985`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetCoordinates", "[", 
   RowBox[{"Cartesian", "[", 
    RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "]"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"EulerEquations", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], ".", 
     RowBox[{"Grad", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"phi", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   ButtonBox["FirstIntegrals",
    BaseStyle->"Link",
    ButtonData->"paclet:VariationalMethods/ref/FirstIntegrals"], "[", 
   StyleBox["f", "TI"], ",", 
   StyleBox["u", "TI"], "[", 
   StyleBox["x", "TI"], "]", ",", 
   StyleBox["x", "TI"], "]", ",", 
   ButtonBox["FirstIntegrals",
    BaseStyle->"Link",
    ButtonData->"paclet:VariationalMethods/ref/FirstIntegrals"], "[", 
   StyleBox["f", "TI"], ",", "{", 
   StyleBox["u", "TI"], "[", 
   StyleBox["x", "TI"], "]", ",", 
   StyleBox["v", "TI"], "[", 
   StyleBox["x", "TI"], "]", ",", 
   StyleBox["\[Ellipsis]", "TR"], "}", ",", 
   StyleBox["x", "TI"], "]"}]]],
 " ",
 Cell[BoxData[Cell[TextData[{
   "give first integrals when the integrand ",
   Cell[BoxData[
    StyleBox["f", "TI"]], "InlineFormula"],
   " is independent of one or more of ",
   Cell[BoxData[
    RowBox[{"{", 
     StyleBox["u", "TI"], "[", 
     StyleBox["x", "TI"], "]", ",", 
     StyleBox["v", "TI"], "[", 
     StyleBox["x", "TI"], "]", ",", 
     StyleBox["\[Ellipsis]", "TR"], "}"}]], "InlineFormula"],
   ", or independent of ",
   Cell[BoxData[
    StyleBox["x", "TI"]], "InlineFormula"]
  }], "TableText"]]]
}], "Text",
 CellChangeTimes->{{3.469883025161982*^9, 3.469883034521995*^9}}],

Cell[TextData[{
 "When there is only one independent variable ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 ", ",
 Cell[BoxData[
  ButtonBox["FirstIntegrals",
   BaseStyle->"Link",
   ButtonData->"paclet:VariationalMethods/ref/FirstIntegrals"]], 
  "InlineFormula"],
 " gives conserved quantities in the following cases: \
(1)\[NonBreakingSpace]if ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 " does not depend on a coordinate ",
 Cell[BoxData[
  StyleBox["u", "TI"]], "InlineFormula"],
 " explicitly, it is referred to as an ignorable coordinate and the \
corresponding Euler equation possesses an obvious first integral (a conserved \
generalized momentum), and (2)\[NonBreakingSpace]if ",
 Cell[BoxData[
  StyleBox["f", "TI"]], "InlineFormula"],
 " depends on ",
 Cell[BoxData[
  RowBox[{
   StyleBox["u", "TI"], ",", 
   StyleBox["v", "TI"], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula"],
 " and their first derivatives only and has no explicit ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 " dependence, ",
 Cell[BoxData[
  ButtonBox["FirstIntegrals",
   BaseStyle->"Link",
   ButtonData->"paclet:VariationalMethods/ref/FirstIntegrals"]], 
  "InlineFormula"],
 " also returns the first integral corresponding to the Hamiltonian. "
}], "Text",
 CellChangeTimes->{3.469883042572006*^9}],

Cell[TextData[{
 "The Lagrangian for central force motion has an ignorable coordinate ",
 Cell[BoxData[
  StyleBox["\[Phi]", "TR"]], "InlineFormula"],
 " (angular momentum conservation) and is independent of time ",
 Cell[BoxData[
  StyleBox["t", "TI"]], "InlineFormula"],
 " (energy conservation). ",
 Cell[BoxData[
  ButtonBox["FirstIntegrals",
   BaseStyle->"Link",
   ButtonData->"paclet:VariationalMethods/ref/FirstIntegrals"]], 
  "InlineFormula"],
 " yields both the first integral corresponding to coordinate ",
 Cell[BoxData[
  StyleBox["\[Phi]", "TR"]], "InlineFormula"],
 " and the first integral corresponding to the Hamiltonian. "
}], "Text",
 CellChangeTimes->{3.469883053212021*^9}],

Cell[BoxData[
 RowBox[{"FirstIntegrals", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["r", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["phi", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], "-", 
    RowBox[{"U", "[", "r", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", "t", "]"}], ",", 
     RowBox[{"phi", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]], "Input"],

Cell["\<\
The Lagrangian of a particle in 2 dimensions with a central potential:\
\>", "Text",
 CellChangeTimes->{3.4698830923540773`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "m", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{"r", "'"}], "[", "t", "]"}], "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "2"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "2"]}]}], ")"}]}], "-", 
    RowBox[{"V", "[", 
     RowBox[{"r", "[", "t", "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[TextData[{
 "The coordinates with conserved first integrals are the angle ",
 Cell[BoxData[
  StyleBox["\[Theta]", "TR"]], "InlineFormula"],
 " and the time ",
 Cell[BoxData[
  StyleBox["t", "TI"]], "InlineFormula"],
 ", corresponding to conservation of angular momentum and energy:"
}], "Text",
 CellChangeTimes->{3.4698831006440887`*^9}],

Cell[BoxData[
 RowBox[{"FirstIntegrals", "[", 
  RowBox[{"\[ScriptCapitalL]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], ",", "t"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical Solution to ODE'S", "Subsection",
 CellChangeTimes->{{3.4698128485972457`*^9, 3.46981285879726*^9}}],

Cell[TextData[{
 "Required Reading:\n\n",
 ButtonBox["Numerical Solution of Differential Equations",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/NumericalSolutionOfDifferentialEquations"],
 "\n",
 ButtonBox["Advanced Numerical Differential Equation Solving in ",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/NDSolveOverview"],
 StyleBox[ButtonBox["Mathematica",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/NDSolveOverview"],
  FontSlant->"Italic"],
 ButtonBox["\n",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/NDSolveOverview"],
 ButtonBox["Stiffness Detection",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/NDSolveStiffnessTest"],
 "\n"
}], "Text",
 CellChangeTimes->{{3.469952286653916*^9, 3.4699523207460513`*^9}, {
  3.470023632851777*^9, 3.4700236448017936`*^9}}],

Cell[TextData[{
 "In the category of numerical methods, one of  the most important built\
\[Hyphen]in command is ",
 ButtonBox["NDSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/NDSolve"],
 " for solving ordinary (also nonlinear and stiff) systems of differential \
equations."
}], "Text",
 CellChangeTimes->{
  3.469812874737282*^9, {3.4700226120983286`*^9, 3.470022630998355*^9}}],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   ButtonBox["NDSolve",
    BaseStyle->"Link",
    ButtonData->"paclet:ref/NDSolve"], "[", 
   RowBox[{
    StyleBox["eqns", "TI"], ",", 
    StyleBox["y", "TI"], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["x", "TI"], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["min", "TI"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["max", "TI"]]}], "}"}]}], "]"}]], "InlineFormula"],
 "finds a numerical solution to the ordinary differential equations ",
 Cell[BoxData[
  StyleBox["eqns", "TI"]], "InlineFormula"],
 " for the function ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula"],
 " with the independent variable ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 " in the range ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["x", "TI"], 
   StyleBox["min", "TI"]]], "InlineFormula"],
 " to ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["x", "TI"], 
   StyleBox["max", "TI"]]], "InlineFormula"],
 "."
}], "Text",
 CellChangeTimes->{{3.469812883169298*^9, 3.4698128881093054`*^9}}],

Cell["\<\
We start with one of the simplest ODE's: the harmonic oscillator:\
\>", "Text",
 CellChangeTimes->{{3.469813098413607*^9, 3.469813119953637*^9}}],

Cell[BoxData[{
 RowBox[{"dg1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "''"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"-", 
      RowBox[{"x", "[", "t", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"x", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "1"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol1", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{"dg1", ",", 
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.469813011349478*^9, 3.469813030491506*^9}, 
   3.469813066603563*^9, {3.469813923828847*^9, 3.469813946098878*^9}, 
   3.469814019718981*^9}],

Cell[TextData[{
 ButtonBox["NDSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/NDSolve"],
 " returns its solution(s) in form of ",
 ButtonBox["InterpolationFunction",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/InterpolationFunction"],
 "s. They can be for further processing just lika any other symbolic solution."
}], "Text",
 CellChangeTimes->{{3.470022659078394*^9, 3.4700227374425063`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], " ", "/.", " ", "sol1"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469813083953587*^9, 3.4698130869135914`*^9}, {
  3.469813951858886*^9, 3.4698139523088865`*^9}}],

Cell["Here is a harmonic oscillator with a nonlinear damping", "Text",
 CellChangeTimes->{
  3.4699505496099977`*^9, {3.470022746302519*^9, 3.470022748642522*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Eta]", " ", "=", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "1"}]}]}], ",", " ", 
     RowBox[{"T", " ", "=", " ", "80"}]}], "}"}], ",", "\n", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], " ", "/.", " ", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"use", " ", "constant"}], "-", 
          RowBox[{"period", " ", "damping"}]}], " ", "*)"}], "CodeComment"], 
       "\n", "        ", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "''"}], "[", "t", "]"}], " ", "==", " ", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "t", "]"}], " ", "+", " ", 
                RowBox[{"\[Eta]", " ", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"x", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "'"}], "[", "t", "]"}], "/", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"x", "'"}], "[", "t", "]"}], "]"}]}]}]}], 
               ")"}]}]}], ",", "\n", "         ", 
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], " ", "==", " ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "'"}], "[", "0", "]"}], " ", "==", " ", "1"}]}], 
           "}"}], ",", " ", "x", ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "T"}], "}"}], ",", "\n", "     ", 
     RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
     RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.46995057829204*^9, 3.469950579502042*^9}}],

Cell["\<\
A  differential\[Hyphen]algebraic equation.\
\>", "Text",
 CellChangeTimes->{{3.469950650606144*^9, 3.4699506513261447`*^9}}],

Cell[BoxData[
 RowBox[{"ndsol", " ", "=", " ", "\n", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "t", "]"}], " ", "==", " ", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"x", "[", "t", "]"}]}], " ", "+", " ", 
        RowBox[{"3", " ", 
         RowBox[{"z", "[", "t", "]"}]}]}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "t", "]"}], " ", "==", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"x", "[", "t", "]"}]}], " ", "+", " ", 
        RowBox[{"y", "[", "t", "]"}], " ", "+", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"y", "[", "t", "]"}], "]"}]}]}], ",", "\n", "         ", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{"no", " ", "z", " ", "derivative"}], " ", "*)"}], 
       "CodeComment"], " ", 
      RowBox[{
       RowBox[{"z", "[", "t", "]"}], " ", "==", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"y", "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"z", "[", "t", "]"}], "^", "3"}]}]}], ",", "\n", "         ", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"no", " ", "initial", " ", "z"}], "-", "value"}], " ", 
        "*)"}], "CodeComment"], " ", 
      RowBox[{
       RowBox[{"x", "[", "0", "]"}], " ", "==", " ", "1"}], ",", " ", 
      RowBox[{
       RowBox[{"y", "[", "0", "]"}], " ", "==", " ", 
       RowBox[{"-", "1"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], ",", "\n", 
    "        ", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", 
      RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.469950659676156*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", " ", 
       RowBox[{"y", "[", "t", "]"}], ",", " ", 
       RowBox[{"z", "[", "t", "]"}]}], "}"}], " ", "/.", " ", 
     RowBox[{"ndsol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", 
     RowBox[{"-", "1"}], ",", " ", "1"}], "}"}], ",", "\n", "     ", 
   RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
   RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
   RowBox[{"PlotRange", " ", "->", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469950679288185*^9, 3.4699506826281896`*^9}}],

Cell[TextData[{
 ButtonBox["NDSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/NDSolve"],
 " also solves large systems of differential equations in an acceptable time. \
Here is a system of 10 second\[Hyphen]order differential equations that are \
coupled nonlinearly with one another. We chose the constants and the \
exponents randomly. "
}], "Text",
 CellChangeTimes->{{3.4698142484793663`*^9, 3.4698142524993725`*^9}, {
  3.4700227659445477`*^9, 3.4700227659445477`*^9}}],

Cell["\<\
num = 10;
SeedRandom[1234567];
(diffEqn = Table[x[i]''[t] == Sum[Random[Integer, {-2, 2}] *
                        x[j][t]^Random[Integer, {0, 3}], {j, num}],
                 {i, num}]) // Short[#, 16]&\
\>", "Input",
 CellChangeTimes->{{3.470022790594582*^9, 3.4700227912145824`*^9}}],

Cell["Next, we add initial conditions. ", "Text",
 CellChangeTimes->{3.469814263511389*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"diffEqn", ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], " ", "[", "0", "]"}], " ", "==", " ", 
        "1"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "num"}], "}"}]}], "]"}], ",", "\n", 
     "                    ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], "'"}], "[", "0", "]"}], " ", "==", 
        " ", "1"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "num"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell["\<\
Here is the solution of the system of differential equations. \
\>", "Text",
 CellChangeTimes->{3.469814268161395*^9}],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{"eqn", ",", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "num"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}], " ", "/.", " ", 
       "sol"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "num"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "0", ",", " ", 
      RowBox[{"1", "/", "2"}]}], "}"}], ",", "\n", "     ", 
    RowBox[{"PlotStyle", " ", "->", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Hue", "[", 
        RowBox[{
         RowBox[{"j", "/", "10"}], " ", "0.7"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "num"}], "}"}]}], "]"}]}], ",", " ", 
    RowBox[{"PlotRange", " ", "->", " ", "All"}]}], "]"}], "]"}]], "Input"],

Cell["\<\
The following are the Lotka-Volterra Equations, describing predator-prey \
relations\
\>", "Text",
 CellChangeTimes->{{3.4698148487526627`*^9, 3.469814871162694*^9}}],

Cell[BoxData[
 RowBox[{"NDSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], "-", "1"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"y", "[", "t", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"x", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
     RowBox[{
      RowBox[{"y", "[", "0", "]"}], "\[Equal]", "2.7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], "/.", 
     RowBox[{"First", "[", "%", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4698148329726405`*^9, 3.469814833802642*^9}}],

Cell["Here is the corresponding Phase-plane plot", "Text",
 CellChangeTimes->{{3.4698148780427036`*^9, 3.469814889292719*^9}, {
  3.4700228154146166`*^9, 3.47002281815462*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], "/.", 
     RowBox[{"First", "[", "%%", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.469814894922727*^9}],

Cell["\<\
Next we examine two masses connected by a spring, one mass connected to the \
origin by spring \
\>", "Text",
 CellChangeTimes->{{3.4699698043937707`*^9, 3.469969841953823*^9}, {
  3.47002282482463*^9, 3.4700228302346373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spring", "[", 
    RowBox[{"xkezd_", ",", "ykezd_", ",", "xveg_", ",", "yveg_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hx", "=", 
       RowBox[{"xveg", "-", "xkezd"}]}], ";", 
      RowBox[{"hy", "=", 
       RowBox[{"yveg", "-", "ykezd"}]}], ";", 
      RowBox[{"szel", "=", "0.2"}], ";", 
      RowBox[{"veghossz", "=", "0.3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"hossz", "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["hx", "2"], "+", 
         SuperscriptBox["hy", "2"]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dh", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hossz", "-", 
          RowBox[{"2", "*", "veghossz"}]}], ")"}], "/", "30"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"xkezd", ",", "ykezd"}], "}"}]}], "}"}], "~", "Join", "~", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xkezd", "+", 
        RowBox[{"hx", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dh", "+", "veghossz"}], ")"}], "/", "hossz"}]}]}], ",", 
       RowBox[{"ykezd", "+", 
        RowBox[{"hy", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dh", "+", "veghossz"}], ")"}], "/", "hossz"}]}]}]}], 
      "}"}], "}"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OddQ", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xkezd", "+", 
           RowBox[{"hx", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", "*", "dh"}], "+", "veghossz"}], ")"}], "/", 
             "hossz"}]}], "+", 
           RowBox[{"hy", "*", 
            RowBox[{"szel", "/", "hossz"}]}]}], ",", 
          RowBox[{"ykezd", "+", 
           RowBox[{"hy", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", "*", "dh"}], "+", "veghossz"}], ")"}], "/", 
             "hossz"}]}], "-", 
           RowBox[{"hx", "*", 
            RowBox[{"szel", "/", "hossz"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xkezd", "+", 
           RowBox[{"hx", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", "*", "dh"}], "+", "veghossz"}], ")"}], "/", 
             "hossz"}]}], "-", 
           RowBox[{"hy", "*", 
            RowBox[{"szel", "/", "hossz"}]}]}], ",", 
          RowBox[{"ykezd", "+", 
           RowBox[{"hy", "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"i", "*", "dh"}], "+", "veghossz"}], ")"}], "/", 
             "hossz"}]}], "+", 
           RowBox[{"hx", "*", 
            RowBox[{"szel", "/", "hossz"}]}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", "28"}], "}"}]}], "]"}], "~", "Join", "~", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xkezd", "+", 
        RowBox[{"hx", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"29", "*", "dh"}], "+", "veghossz"}], ")"}], "/", 
          "hossz"}]}]}], ",", 
       RowBox[{"ykezd", "+", 
        RowBox[{"hy", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"29", "*", "dh"}], "+", "veghossz"}], ")"}], "/", 
          "hossz"}]}]}]}], "}"}], "}"}], "~", "Join", "~", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"xveg", ",", "yveg"}], "}"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4699703578160915`*^9, 3.469970607408797*^9}, {
   3.4699707323249764`*^9, 3.4699707359849815`*^9}, {3.469970794187064*^9, 
   3.469970868733181*^9}, {3.4699709434972887`*^9, 3.4699709705573263`*^9}, 
   3.4722059172236543`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Green", ",", 
     RowBox[{"Line", "@", 
      RowBox[{"spring", "[", 
       RowBox[{"1", ",", "0", ",", "4", ",", "0"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "Blue", ",", 
     RowBox[{"Line", "@", 
      RowBox[{"spring", "[", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "Black", ",", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PointSize", "[", "0.075", "]"}], ",", "Red", ",", 
     RowBox[{"Point", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "0"}], "}"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", "Black", ",", "Thick", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "0.25"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"-", "0.25"}]}], "}"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(1\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.4"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(2\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"2.5", ",", "0.4"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(1\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1.05", ",", "0.35"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(2\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "0.35"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4699703578160915`*^9, 3.469970607408797*^9}, {
   3.4699707323249764`*^9, 3.4699707359849815`*^9}, {3.469970794187064*^9, 
   3.469970868733181*^9}, {3.4699709434972887`*^9, 3.4699709705573263`*^9}, 
   3.4722059172236543`*^9}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 1, 0], 
    LineBox[{{1, 0}, {1.38, 0}, {1.46, 0.2}, {1.54, -0.2}, {1.62, 0.2}, {
      1.7, -0.2}, {1.78, 0.2}, {1.86, -0.2}, {1.94, 0.2}, {2.02, -0.2}, {2.1, 
      0.2}, {2.1799999999999997`, -0.2}, {2.26, 0.2}, {2.34, -0.2}, {2.42, 
      0.2}, {2.5, -0.2}, {2.58, 0.2}, {2.66, -0.2}, {2.7399999999999998`, 
      0.2}, {2.8200000000000003`, -0.2}, {2.9, 0.2}, {
      2.9799999999999995`, -0.2}, {3.06, 0.2}, {3.14, -0.2}, {
      3.2199999999999998`, 0.2}, {3.3, -0.2}, {3.38, 0.2}, {3.46, -0.2}, {
      3.54, 0.2}, {3.6199999999999997`, 0}, {4, 0}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0, 0}, {0.3133333333333333, 0}, {0.32666666666666666`, 0.2}, {
      0.33999999999999997`, -0.2}, {0.35333333333333333`, 0.2}, {
      0.36666666666666664`, -0.2}, {0.38, 0.2}, {0.3933333333333333, -0.2}, {
      0.4066666666666667, 0.2}, {0.42, -0.2}, {0.43333333333333335`, 0.2}, {
      0.44666666666666666`, -0.2}, {0.45999999999999996`, 0.2}, {
      0.47333333333333333`, -0.2}, {0.4866666666666667, 0.2}, {0.5, -0.2}, {
      0.5133333333333333, 0.2}, {0.5266666666666666, -0.2}, {0.54, 0.2}, {
      0.5533333333333333, -0.2}, {0.5666666666666667, 0.2}, {
      0.5800000000000001, -0.2}, {0.5933333333333333, 0.2}, {
      0.6066666666666667, -0.2}, {0.62, 0.2}, {0.6333333333333333, -0.2}, {
      0.6466666666666667, 0.2}, {0.66, -0.2}, {0.6733333333333333, 0.2}, {
      0.6866666666666668, 0}, {1, 0}}]}, 
   {GrayLevel[0], PointSize[0.05], PointBox[{1, 0}]}, 
   {RGBColor[1, 0, 0], PointSize[0.075], PointBox[{4, 0}], 
    {GrayLevel[0], Thickness[Large], 
     LineBox[{{0, 0.4}, {0, -0.25}, {5, -0.25}}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(k\\), \\(1\\)]\\)\"\>", \
{0.5, 0.4}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(k\\), \\(2\\)]\\)\"\>", \
{2.5, 0.4}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)\"\>", \
{1.05, 0.35}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(2\\)]\\)\"\>", \
{4, 0.35}]}}},
  Frame->False]], "Output",
 CellChangeTimes->{{3.4699704061662755`*^9, 3.4699704311363106`*^9}, {
   3.4699704861963882`*^9, 3.4699705731345153`*^9}, {3.4699706042896767`*^9, 
   3.4699706078287973`*^9}, 3.469970739094986*^9, {3.4699708147130966`*^9, 
   3.4699708693551826`*^9}, 3.469982858429469*^9, 3.470034521755164*^9, 
   3.4701307252395315`*^9, 3.470131260708093*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x1", "''"}], "[", "t", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"x1", "[", "t", "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2", "[", "t", "]"}], "-", 
           RowBox[{"x1", "[", "t", "]"}]}], ")"}]}]}]}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "1"], "=", "1"}], ",", 
        RowBox[{
         SubscriptBox["m", "1"], "=", "1"}], ",", 
        RowBox[{
         SubscriptBox["k", "2"], "=", "3"}], ",", 
        RowBox[{
         SubscriptBox["m", "2"], "=", "2"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{
         RowBox[{"x2", "''"}], "[", "t", "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "3"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x2", "[", "t", "]"}], "-", 
          RowBox[{"x1", "[", "t", "]"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x2", "[", "0", "]"}], "==", "4"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"x1", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"x2", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "20"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.469967772662098*^9, 3.469967828374177*^9}, {
  3.4699687101976137`*^9, 3.4699688242497745`*^9}, {3.469969505693218*^9, 
  3.4699695131632285`*^9}, {3.4699695557132883`*^9, 3.469969570467311*^9}, {
  3.469969660809566*^9, 3.4699697010796223`*^9}, {3.4699708812852*^9, 
  3.4699709336472745`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], ",", 
       RowBox[{"x2", "[", "t", "]"}]}], "}"}], "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4699688426298*^9, 3.469968890489867*^9}, {
  3.4699689600019655`*^9, 3.4699689682319775`*^9}}],

Cell[BoxData[
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Green", ",", 
        RowBox[{"Line", "@", 
         RowBox[{"spring", "[", 
          RowBox[{
           RowBox[{"x1", "[", "t", "]"}], ",", "0", ",", 
           RowBox[{"x2", "[", "t", "]"}], ",", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "Blue", ",", 
        RowBox[{"Line", "@", 
         RowBox[{"spring", "[", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"x1", "[", "t", "]"}], ",", "0"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", "Red", ",", 
        RowBox[{"PointSize", "[", "0.075", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "/.", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "20", ",", "0.01"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469969019652049*^9, 3.469969103394168*^9}, {
   3.469969220378454*^9, 3.469969475711175*^9}, 3.4699697225216537`*^9, {
   3.469969946343975*^9, 3.46996995530506*^9}, 3.469970170916464*^9, {
   3.4699702016985083`*^9, 3.4699702027885103`*^9}, {3.469970238028559*^9, 
   3.469970303968707*^9}, {3.4699703462660756`*^9, 3.469970347516077*^9}, {
   3.46997062393882*^9, 3.4699706322888317`*^9}, {3.4699707559770107`*^9, 
   3.4699707586970143`*^9}, {3.4699709812793427`*^9, 3.4699709988993673`*^9}}],

Cell["Two coupled pendula", "Text",
 CellChangeTimes->{{3.469972517155756*^9, 3.469972523465765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"x1", "''"}], "[", "t", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"-", "g", " "}], "l"], 
           RowBox[{"x1", "[", "t", "]"}]}], "-", 
          RowBox[{
           FractionBox["k", "m1"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], "-", 
             RowBox[{"x2", "[", "t", "]"}]}], ")"}]}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"x2", "''"}], "[", "t", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"-", "g", " "}], "l"], 
           RowBox[{"x2", "[", "t", "]"}]}], "-", 
          RowBox[{
           FractionBox["k", "m2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], "-", 
             RowBox[{"x2", "[", "t", "]"}]}], ")"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x1", "[", "0", "]"}], "\[Equal]", 
         RowBox[{"-", "5"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "5"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"x1", "'"}], "[", "1", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"x2", "'"}], "[", "1", "]"}], "\[Equal]", "1.2"}]}], "}"}], 
      "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m1", "->", "1"}], ",", 
        RowBox[{"m2", "\[Rule]", "10"}], ",", 
        RowBox[{"k", "\[Rule]", "1"}], ",", 
        RowBox[{"l", "\[Rule]", "2"}], ",", 
        RowBox[{"g", "\[Rule]", "10"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "300"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4699710799425964`*^9, 3.469971185061859*^9}, {
  3.46997137116212*^9, 3.4699713883641453`*^9}, {3.4699714483342295`*^9, 
  3.469971459654245*^9}, {3.4699715392943563`*^9, 3.4699716779985533`*^9}, {
  3.4699717102685986`*^9, 3.469971731510629*^9}, {3.469971786260706*^9, 
  3.4699718290927672`*^9}, {3.4699720222630377`*^9, 3.469972110645169*^9}, {
  3.4699721528792305`*^9, 3.4699722670893965`*^9}, {3.469972371103544*^9, 
  3.4699723720335455`*^9}, {3.4699725059657407`*^9, 3.469972551187805*^9}, {
  3.4699828950257516`*^9, 3.4699829576598425`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Animate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Green", ",", 
         RowBox[{"Line", "@", 
          RowBox[{"spring", "[", 
           RowBox[{
            RowBox[{"x1", "[", "t", "]"}], ",", 
            RowBox[{"-", "2"}], ",", 
            RowBox[{"x2", "[", "t", "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", "Blue",
          ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", "Blue", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"5", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x2", "[", "t", "]"}], ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", "Black", ",", 
         RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "Red", ",", 
         RowBox[{"PointSize", "[", "0.075", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x2", "[", "t", "]"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], "]"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "/.", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "27"}], ",", "27"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "0.6"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "50", ",", "0.01"}], "}"}], ",", 
    RowBox[{"AnimationRate", "\[Rule]", "0.75"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4699710799425964`*^9, 3.469971185061859*^9}, {
  3.46997137116212*^9, 3.4699713883641453`*^9}, {3.4699714483342295`*^9, 
  3.469971459654245*^9}, {3.4699715392943563`*^9, 3.4699716779985533`*^9}, {
  3.4699717102685986`*^9, 3.469971731510629*^9}, {3.469971786260706*^9, 
  3.4699718290927672`*^9}, {3.4699720222630377`*^9, 3.469972110645169*^9}, {
  3.4699721528792305`*^9, 3.4699722670893965`*^9}, {3.469972371103544*^9, 
  3.4699723720335455`*^9}, {3.4699725059657407`*^9, 3.469972551187805*^9}, {
  3.4699828950257516`*^9, 3.469982906245767*^9}}],

Cell["Two-armed pendulum: Let us start with the Lagrangian:", "Text",
 CellChangeTimes->{{3.469994075322021*^9, 3.4699941060860868`*^9}, {
  3.4700228789447055`*^9, 3.470022880914708*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "m1", " ", 
     SuperscriptBox["l1", "2"], 
     SuperscriptBox[
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"]}], 
    "+", 
    RowBox[{
     FractionBox["1", "2"], "m2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["l1", "2"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]", "[", "1", "]"}], "'"}], "[", "t", "]"}], 
         "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]", "[", "2", "]"}], "'"}], "[", "t", "]"}], 
         "2"]}], "+", 
       RowBox[{"2", "l1", " ", "l2", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "[", "1", "]"}], "'"}], "[", "t", "]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "[", "2", "]"}], "'"}], "[", "t", "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "-", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{
    RowBox[{"m1", " ", "g", 
     RowBox[{"(", 
      RowBox[{"l1", "+", "l2", "-", 
       RowBox[{"l1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "]"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"m2", " ", "g", 
     RowBox[{"(", 
      RowBox[{"l1", "+", "l2", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], 
         "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "2", "]"}], "[", "t", "]"}], "]"}]}]}], 
        ")"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"L", "=", 
  RowBox[{"T", "-", "V"}]}], "\[IndentingNewLine]", 
 RowBox[{"L", "=", 
  RowBox[{"L", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1", "\[Rule]", "l"}], ",", 
     RowBox[{"l2", "\[Rule]", "l"}], ",", 
     RowBox[{"m1", "\[Rule]", "m"}], ",", 
     RowBox[{"m2", "\[Rule]", "m"}]}], "}"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"let", "'"}], "s", " ", "simplify", " ", "a", " ", "little"}], 
    " ", "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.469983120630111*^9, 3.469983353262438*^9}, {
  3.4699888036061387`*^9, 3.4699888283161736`*^9}, {3.46999075500304*^9, 
  3.469990805633111*^9}, {3.4699945568327217`*^9, 3.4699945902147694`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["\[DifferentialD]", 
       RowBox[{"\[DifferentialD]", "t"}],
       MultilineFunction->None], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[PartialD]", "L"}], 
        RowBox[{"\[PartialD]", 
         SubscriptBox[
          OverscriptBox["\[Theta]", "."], "1"]}]], ")"}]}], "-", 
     FractionBox[
      RowBox[{"\[PartialD]", "L"}], 
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Theta]", "1"]}]]}], "\[Equal]", "0"}], " ", ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["\[DifferentialD]", 
       RowBox[{"\[DifferentialD]", "t"}],
       MultilineFunction->None], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[PartialD]", "L"}], 
        RowBox[{"\[PartialD]", 
         SubscriptBox[
          OverscriptBox["\[Theta]", "."], "2"]}]], ")"}]}], "-", 
     FractionBox[
      RowBox[{"\[PartialD]", "L"}], 
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Theta]", "2"]}]]}], "\[Equal]", 
    RowBox[{
    "0", "  ", "are", " ", "the", " ", "Lagrange", " ", "equations", " ", 
     "connected", " ", "to", " ", 
     SubscriptBox["\[Theta]", "1"], "and", " ", 
     RowBox[{
      SubscriptBox["\[Theta]", "2"], "."}]}]}]}], TraditionalForm]], "Text",
 CellChangeTimes->{{3.4699941178761034`*^9, 3.469994206178228*^9}, {
  3.4699942441582813`*^9, 3.4699943499404306`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"L", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
           "]"}], ",", "t", ",", " ", 
          RowBox[{"Constants", " ", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "l", ",", "g"}], "}"}]}]}], "]"}], "-", 
        RowBox[{"D", "[", 
         RowBox[{"L", ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
       "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"eq2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"L", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "[", "2", "]"}], "'"}], "[", "t", "]"}]}], 
           "]"}], ",", "t", ",", " ", 
          RowBox[{"Constants", " ", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "l", ",", "g"}], "}"}]}]}], "]"}], "-", 
        RowBox[{"D", "[", 
         RowBox[{"L", ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
       "\[Equal]", "0"}], "//", "FullSimplify"}]}]}], "}"}], ";"}]], "Input",
 CellChangeTimes->{{3.4699833591124463`*^9, 3.469983425382539*^9}, {
  3.4699834570125833`*^9, 3.4699835063526525`*^9}, {3.4699835379726963`*^9, 
  3.469983566722737*^9}, {3.469988625045889*^9, 3.4699886637259426`*^9}, {
  3.4699888923162627`*^9, 3.4699888978362703`*^9}, {3.469988984458393*^9, 
  3.4699889890283995`*^9}, {3.4699890468284807`*^9, 3.4699890485784826`*^9}, {
  3.469989227412736*^9, 3.469989261212783*^9}, {3.4699908161731253`*^9, 
  3.469990837183155*^9}}],

Cell[TextData[{
 "Divide both sides of the equation by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"l", " ", "m"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.4699943619124484`*^9, 3.4699943820824766`*^9}}],

Cell[BoxData[{
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "/", 
     RowBox[{"(", 
      RowBox[{"l", " ", "m"}], ")"}]}], "&"}], "/@", 
   "eq1"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "/", 
     RowBox[{"(", 
      RowBox[{"l", " ", "m"}], ")"}]}], "&"}], "/@", "eq2"}]}]}], "Input",
 CellChangeTimes->{{3.4699926657718625`*^9, 3.46999269974191*^9}}],

Cell["Insert numbers", "Text",
 CellChangeTimes->{{3.469994386502483*^9, 3.4699943912324896`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{"eq1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", "\[Rule]", "9.8"}], ",", 
      RowBox[{"l", "\[Rule]", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{"eq2", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g", "\[Rule]", "9.8"}], ",", 
      RowBox[{"l", "\[Rule]", "1"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.469992738101964*^9, 3.469992750601981*^9}, {
  3.469994607244793*^9, 3.469994608284795*^9}}],

Cell["sol solves any given set of initial conditions", "Text",
 CellChangeTimes->{{3.46999440592251*^9, 3.4699944169925256`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "[", 
   RowBox[{
    RowBox[{"a1_", "?", "NumberQ"}], ",", 
    RowBox[{"a2_", "?", "NumberQ"}], ",", 
    RowBox[{"v1_", "?", "NumberQ"}], ",", 
    RowBox[{"v2_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eq1", ",", "eq2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", 
       "a1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", 
       "a2"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "[", "1", "]"}], "'"}], "[", "0", "]"}], 
       "\[Equal]", "v1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "[", "2", "]"}], "'"}], "[", "0", "]"}], 
       "\[Equal]", "v2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], ",", 
      RowBox[{"\[Theta]", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "100"}], "}"}], ",", 
    RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.469993513419063*^9, 3.469993518999071*^9}, {
  3.469993639287408*^9, 3.469993659097436*^9}, {3.46999369075748*^9, 
  3.4699937621575804`*^9}}],

Cell["The {x,y] coordinates of the both arms", "Text",
 CellChangeTimes->{{3.469994447182568*^9, 3.4699944589825845`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pos", "[", "1", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "]"}], ",", 
    RowBox[{"-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pos", "[", "2", "]"}], "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "]"}], "+", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "1", "]"}], "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "2", "]"}], "[", "t", "]"}], "]"}]}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.4699928158720727`*^9, 3.469992904032196*^9}, {
  3.4699930990624695`*^9, 3.469993114592491*^9}, {3.4699931741025743`*^9, 
  3.469993182692586*^9}, {3.469993348134819*^9, 3.4699933543248277`*^9}, {
  3.469993397324898*^9, 3.4699934370549536`*^9}}],

Cell["This function actually draws the animation.", "Text",
 CellChangeTimes->{{3.4699944239925356`*^9, 3.469994437212554*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pendel", "[", 
   RowBox[{
    RowBox[{"a1_", "?", "NumberQ"}], ",", 
    RowBox[{"a2_", "?", "NumberQ"}], ",", 
    RowBox[{"v1_", "?", "NumberQ"}], ",", 
    RowBox[{"v2_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"pos", "[", "1", "]"}], "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"pos", "[", "2", "]"}], "[", "t", "]"}]}], "}"}], "]"}], 
         ",", 
         RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{
           RowBox[{"pos", "[", "1", "]"}], "[", "t", "]"}], "]"}], ",", "Red",
          ",", 
         RowBox[{"Point", "[", 
          RowBox[{
           RowBox[{"pos", "[", "2", "]"}], "[", "t", "]"}], "]"}]}], "}"}], "/.", 
       RowBox[{"sol", "[", 
        RowBox[{"a1", ",", "a2", ",", "v1", ",", "v2"}], "]"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.5"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1", ",", "50", ",", "0.002"}], "}"}], ",", 
    RowBox[{"AnimationRate", "\[Rule]", "0.75"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4699939385818295`*^9, 3.46999396035186*^9}, {
  3.469993998911914*^9, 3.4699940032519197`*^9}}],

Cell[BoxData[
 RowBox[{"pendel", "[", 
  RowBox[{"0", ",", "3", ",", "0", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.4699929215622206`*^9, 3.4699930527124043`*^9}, {
   3.4699931243525047`*^9, 3.4699931520425434`*^9}, {3.4699931932826014`*^9, 
   3.469993289344737*^9}, 3.4699933221247826`*^9, {3.46999342021493*^9, 
   3.4699934894570284`*^9}, 3.4699935418391027`*^9, {3.4699937688275895`*^9, 
   3.469993771377593*^9}, {3.469993807819645*^9, 3.4699938327896805`*^9}, {
   3.469993863479723*^9, 3.4699938660597267`*^9}, {3.46999396711187*^9, 
   3.469993978301885*^9}}],

Cell[BoxData[
 RowBox[{"pendel", "[", 
  RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.46999446307259*^9, 3.4699944676025963`*^9}}],

Cell[BoxData[
 RowBox[{"pendel", "[", 
  RowBox[{"10", ",", 
   RowBox[{"-", "10"}], ",", "5", ",", 
   RowBox[{"-", "15"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4699944691025987`*^9, 3.4699944795626135`*^9}}],

Cell[TextData[{
 ButtonBox["NDSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/NDSolve"],
 " also solves systems of stiff differential equations."
}], "Text",
 CellChangeTimes->{
  3.4699511850789075`*^9, {3.469952040534472*^9, 3.469952040534472*^9}}],

Cell["\<\
Again we take a look at the pendulum. Consider a mass m, conneted to the \
point {0,0,0} by a massless spring. Let us solve the problem in 3 dimensions:\
\>", "Text",
 CellChangeTimes->{{3.470056915417739*^9, 3.4700569798738394`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Federpendel", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0_", ",", "y0_", ",", "z0_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vx0_", ",", "vy0_", ",", "vz0_"}], "}"}], ",", "m_", ",", 
     "l0_", ",", "k_", ",", "time_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "V", ",", "T", ",", "L", ",", "eq1", ",", "eq2", ",", "eq3", ",", 
       "inipos", ",", "inivel", ",", "sol", ",", 
       RowBox[{"g", "=", "9.81"}], ",", "x", ",", "z", ",", "y"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "=", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "k", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}], "2"]}]], "-", 
            "l0"}], ")"}], "2"]}], "+", 
        RowBox[{"m", " ", "g", " ", 
         RowBox[{
          RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "2"], "m", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{"T", "-", "V"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eq1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"m", ",", "l0", ",", "k", ",", "g"}], "}"}]}]}], 
             "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"z", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"m", ",", "l0", ",", "k", ",", "g"}], "}"}]}]}], 
             "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"m", ",", "l0", ",", "k", ",", "g"}], "}"}]}]}], 
             "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}]}], "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inipos", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", "x0"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", "y0"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", 
          "z0"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inivel", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vx0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "1", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vy0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", "[", "1", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vz0"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"eq1", ",", "eq2", ",", "eq3"}], "}"}], ",", "inipos", 
           ",", "inivel"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"y", "[", "1", "]"}], ",", 
           RowBox[{"z", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "time"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", "0.02", "]"}], ",", "Blue", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], ",", 
                   RowBox[{
                    RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
                   RowBox[{
                    RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "}"}]}], 
                "}"}], "]"}], ",", "Red", ",", 
              RowBox[{"PointSize", "[", "0.1", "]"}], ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "}"}], 
                ",", "0.5"}], "]"}]}], "}"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", 
               RowBox[{"-", "5"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "time", ",", 
          FractionBox["time", "10000."]}], "}"}], ",", 
        RowBox[{"AnimationRate", "\[Rule]", "0.5"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4700536426026945`*^9, 3.470053768898876*^9}, {
   3.4700538590490026`*^9, 3.4700538605690045`*^9}, {3.4700539218990903`*^9, 
   3.4700539262990966`*^9}, {3.4700544334078255`*^9, 3.470054453777854*^9}, {
   3.4700546217680893`*^9, 3.4700546380781116`*^9}, {3.4700549532986307`*^9, 
   3.470055296353175*^9}, {3.470055393509327*^9, 3.470055401181339*^9}, {
   3.4700554346053944`*^9, 3.470055467587448*^9}, {3.470055531795549*^9, 
   3.470055540829564*^9}, {3.4700555766596203`*^9, 3.470055598769657*^9}, {
   3.4700558848501096`*^9, 3.470055887300113*^9}, {3.470055932608183*^9, 
   3.470055932938184*^9}, 3.4700559820402594`*^9, 3.47005609078644*^9, {
   3.47005620600662*^9, 3.4700562233026476`*^9}, {3.4700565020031066`*^9, 
   3.4700565763732243`*^9}, {3.470056652629341*^9, 3.4700566572113485`*^9}, 
   3.470056821977602*^9}],

Cell["\<\
Now we can easily upgrade our model to two masses with two springs:\
\>", "Text",
 CellChangeTimes->{{3.4701298248161135`*^9, 3.470129843814145*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Federpendel2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x10_", ",", "y10_", ",", "z10_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x20_", ",", "y20_", ",", "z20_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vx10_", ",", "vy10_", ",", "vz10_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"vx20_", ",", "vy20_", ",", "vz20_"}], "}"}], ",", "m1_", ",", 
     "m2_", ",", "l01_", ",", "l02_", ",", "k1_", ",", "k2_", ",", "time_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "V", ",", "T", ",", "L", ",", "eq1", ",", "eq2", ",", "eq3", ",", "eq4",
        ",", "eq5", ",", "eq6", ",", "inipos", ",", "inivel", ",", "sol", ",", 
       RowBox[{"g", "=", "9.81"}], ",", "x", ",", "z", ",", "y"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "=", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "k1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{
                RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}], "2"]}]], "-", 
            "l01"}], ")"}], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], "k2", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}]}], ")"}], 
                "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}], ")"}], 
                "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}], "-", 
                  RowBox[{
                   RowBox[{"z", "[", "2", "]"}], "[", "t", "]"}]}], ")"}], 
                "2"]}], ")"}]}], "-", "l02"}], ")"}], "2"]}], "+", 
        RowBox[{"m1", " ", "g", " ", 
         RowBox[{
          RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"m2", " ", "g", " ", 
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], "[", "t", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "m1", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"y", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"z", "[", "1", "]"}], "'"}], "[", "t", "]"}], "2"]}], 
          ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], "m2", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "2", "]"}], "'"}], "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"y", "[", "2", "]"}], "'"}], "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"z", "[", "2", "]"}], "'"}], "[", "t", "]"}], "2"]}], 
          ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{"T", "-", "V"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eq1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1", 
                 ",", "k2"}], "}"}]}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "2", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1", 
                 ",", "k2"}], "}"}]}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1", 
                 ",", "k2"}], "}"}]}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq4", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "2", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1", 
                 ",", "k2"}], "}"}]}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq5", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"z", "[", "1", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1", 
                 ",", "k2"}], "}"}]}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"eq6", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dt", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"L", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"z", "[", "2", "]"}], "'"}], "[", "t", "]"}]}], 
               "]"}], ",", "t", ",", " ", 
              RowBox[{"Constants", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1", 
                 ",", "k2"}], "}"}]}]}], "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{"L", ",", 
              RowBox[{
               RowBox[{"z", "[", "2", "]"}], "[", "t", "]"}]}], "]"}]}], 
           "\[Equal]", "0"}], "//", "FullSimplify"}]}]}], "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inipos", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", "x10"}],
          ",", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", "y10"}],
          ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", "z10"}],
          ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", "x20"}],
          ",", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", "y20"}],
          ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", 
          "z20"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inivel", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vx10"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "1", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vy10"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", "[", "1", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vz10"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "2", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vx20"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "2", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vy20"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", "[", "2", "]"}], "'"}], "[", "0", "]"}], "\[Equal]", 
          "vz20"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", 
             "eq6"}], "}"}], ",", "inipos", ",", "inivel"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"y", "[", "1", "]"}], ",", 
           RowBox[{"y", "[", "2", "]"}], ",", 
           RowBox[{"z", "[", "1", "]"}], ",", 
           RowBox[{"z", "[", "2", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "time"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"Graphics3D", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "[", "0.03", "]"}], ",", "Blue", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Tube", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}], ",", 
                    RowBox[{
                    RowBox[{"z", "[", "2", "]"}], "[", "t", "]"}]}], "}"}]}], 
                 "}"}], ",", "0.3"}], "]"}], ",", "Red", ",", 
              RowBox[{"PointSize", "[", "0.1", "]"}], ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"z", "[", "1", "]"}], "[", "t", "]"}]}], "}"}], 
                ",", "0.6"}], "]"}], ",", "Orange", ",", 
              RowBox[{"Sphere", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "2", "]"}], "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}], ",", 
                  RowBox[{
                   RowBox[{"z", "[", "2", "]"}], "[", "t", "]"}]}], "}"}], 
                ",", "0.6"}], "]"}]}], "}"}], "/.", "sol"}], "]"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", 
               RowBox[{"-", "8"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "time", ",", 
          FractionBox["time", "10000."]}], "}"}], ",", 
        RowBox[{"AnimationRate", "\[Rule]", "0.5"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.470116770915143*^9, 3.470117022983532*^9}, {
  3.4701171410057163`*^9, 3.470117161701749*^9}, {3.4701259327269187`*^9, 
  3.470125971502983*^9}, {3.470126675016073*^9, 3.470126687570093*^9}, {
  3.470126727852153*^9, 3.470126754346192*^9}, {3.4701267908302455`*^9, 
  3.470126794440251*^9}, {3.470126826982298*^9, 3.4701268333523064`*^9}, {
  3.47012688964039*^9, 3.470126891600393*^9}}],

Cell[BoxData[
 RowBox[{"Federpendel2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", "10", ",", "10", ",", "1", 
   ",", "1", ",", "100", ",", "100", ",", "100"}], "]"}]], "Input",
 CellChangeTimes->{{3.4701170498175716`*^9, 3.4701170865416317`*^9}, {
   3.470117198517824*^9, 3.4701172082778378`*^9}, 3.470126578239934*^9, 
   3.470126902430408*^9, {3.4701272806130414`*^9, 3.470127283953046*^9}}],

Cell["\<\
Here is a third version with one spring and a stiff arm, in 2D.\
\>", "Text",
 CellChangeTimes->{{3.470131088464061*^9, 3.470131103288084*^9}, {
  3.470131142096145*^9, 3.4701311757682*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnd+RmzAQxplJBS4htEALVJAZp4B78Gse0wIt8JZnWqAFWnALbkHZsEEj
80cSGLRaab/x3WD77NP3k7RriwW+f/368fWtKIo/8PMTfv5tq0nG5qZeo9x/
x1NOAs/ns23b+/0OG3C3GRWiZUEE9vFmEdiH32VZIoG6rvu+D9O8APIhAOMf
LFdVNb2kSGZGaPtOCL9HwYaJIgH5E4Ag0HWdMlAkIO1a/7ZAgFAAxmEAQDRI
KQignLkAZv0wDM9Rt9stmSCg5SQAvQ/xHzcwLyQmJwEYABAEwDuGgvTk85kw
bQkBISAEhIAQEAJCQAgIASEgBISAEBAC5AT07hiq/TK0BLqu6/seF2Dbti3L
MjwEQgJgFted9D6px+MRvhnks0CNq/GEK5AxELjdbsMwqHFUhP/vhAQgAjRN
A96BAD5CMhIICUD0g4kPEOq6Bg5gP7cxoMZd87iBs4BEMcQBWgkBISAEaAnE
wJ+cgLN+I0AbaOVZxxKmAZHcghMgHgTkY0CRQiD3PjWDkkAMIp8I5BICSiAI
ASEgBEYJBCEgBCwEikkh20Mi7bFYE23bwmhpNh/vS4l36laQKXPvdvsJh8Qt
XzlkBG3KbjZh786eTdK7p3L2riQjSEZYe1wygko0MgTICF3XPR4PvkfsntLv
dV0zJXDWmC8YnrjjxIyA5204r2mX6/SMgGWTZzfzEl2UEVgEgUszghkEsJxe
15Ey0uGMYAYBffgAntTlzPZdrE8yQtM0+GEAeh+M43QYhuF+v5/XwAvlMyns
fPDjENbM65MaAYH4s4N/RnC+lZ71XAj4Z4S97wwzAgdDtLPg0oygxkQAMwLs
4+8PWkqmw95N5eydqZze/UMiO1l8HcgIvGSaOj0jRC7/zk2y6z0l3qlbQSPJ
CJanJCMoyQjJ2feUeKduBY0kI1iekoygJCMkZ99TOXtXKQ77vRICSiAIASEw
SiAIASGgBIIQmAhkyyH5b8d2rX5ftkPQJSWv10tvwwa7olPUFoEtCHhppLIs
8SS9TdPgSXqxrCL+ssOl9hLA83DCs9j7Zq0dXjoNt7mUHVrsbxHASyXiNcLU
e8GtPmEvr7LDvQTU+/UBzYJbvGYcu7LDAwSqqtI9W0wFt2AZzOLg51J0h9pr
H4MAbptBALbxtL2KT9mh1i4C6v2s1Oa2jnvxlx36yA7BLr5lhzPTn0BQPMsO
l44/hMBOq3Zzg7AqgZAPAYvRTCDYXeYAwWkxBwhOHYDA/cDtpQ5AYHHMpvKY
BcZf7oNQMDlw+yICjA7c3tWx/hAYHbi9V54QZkGA4zcmc1V8Jh8IOgjgClLM
M2LVDSYyvdax3C9gh7AMArwI6PUuNU7ndtTaCzchmAdu4yOMCED36auVqWmJ
eC8B88BtVMwEZgK/5iof3K2qaiutWyDMYggjArhHTN+FrjTvLuWMihgJYVxF
uztp5gAaDGMAYiBMh24U5DVcD99+B95fnVabbwZ/54Vci4I3hA/brl/OGsJh
maYzJJDMMvuxVm+9iiOEA01ObGlxz/rA/5vHXzKDYFFx9OJlvCAUF1yujhGB
61rqCYG8Tu/SvnKWZ8RQpxeMwCoEzzo9xXOdTXkQ8KnTi3+dzSKfOiVnnR7e
ZUpAeRzW7azTw6f4ErDLp04PlSoB5VGnh0qYgFOzdba/B9W9pg==
    "], {{0, 160}, {86, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  BaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{86, 160},
  PlotRange->{{0, 86}, {0, 160}}]], "Text"],

Cell["Kinetic and Potential energy look like:", "Text",
 CellChangeTimes->{{3.470131088464061*^9, 3.470131103288084*^9}, {
  3.470131142096145*^9, 3.4701311799002066`*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztXd1tJDcM3iAVXAlxCXELriCAG7iHe81jWnALBlLBtHAtXAvXgluYfFnC
BE1KFDWS9sfHDzhjTivzTxTFobTWH1///uvr76fT6U/8+/e30+n/530xfvz4
sZrFDeLnz5/btuHnHVHeFw9Wr+RLNU0kDuDt7Q0++fDwUOtwF+7qCFn7CJEB
iuPh+fn5+/fvE4WxlGfZsDlYg+i1yTob3gjuwvnvCMqecJ5/SpjiS7Vp8vLy
gnk0Tv8CgClso5Uf05BaXl9f6VdgWEzJcQF8ykXxjmF6TIOc3759w8+gTdbZ
cAQslQPWNELQcZ77xQEV5q5WPBEgBnyGHYm9mvxwnFFxmoDyHS2+WAJU3CjK
D01Vt7iT+/ApW/FGGE2hI/H09CSN4NtknQ1HYKUqQmlaQ9B57g69KsBvT6fT
xMHliSBLFghucCF6RtRdl6dh9McpF8HyzwWHfUJRfrVIwXqRRSEicJOyEu8w
oxUxDX7LsjVtcsCGi0ZcIph+SE0dRJznphC08AEVpmtNE0EGri9fvsjVf8or
v50m4CjjOXOBMPyMh2P6Ou8pI4xk1qrkt/T384pA9fbmutB8sVKjUKQcSaoj
b3B2sAZHB0IyzaZNIppa+HqNe1dwFkhN/W7WeUb2TajwKFu4T5HsgUkd8Zwg
WSWbHAh6BpyNqiYXNRFAyl9otgpqLkdlZ4qTUhiMKUdOGhE4A9F5eXnBp5AK
7cdeOmr2H2SEbrJ+pfrT+zuRpReQh3eMhBpFlhagImUp3gFGe2WwxkcH/WmV
r0neq2mXXoPyW6kimvpQztPLAt32s8pEhKm9nkEqUx8qkh9WR6LpOUGySjYe
GmrBMw0KSD0+Ph7joiaCLKYV0RvTagBTDsVgCvEQS2keycWOq8T7+4yLrAU1
+wcZEYorBfeX8hMwBDQ0aO99fXMcpotss8OBSvu40YIlpkUGjMtfFL4oVe2E
idK0lmwo57Esaq4uZcC8hi5q9wSk0IeCNrUoy1tewdMyvucUrVRU38rGwZme
eURApznFasJL/5HFtCk4GTAjFphWZK4wyMUO3cgCEJsai1uxFMAZ0IifpdNG
GO3ukYZaTANZpDf0DGdr2jAocC9ZK3OQEaE4WONGi5SYFhkwKH9N+KJUzgkT
1tQ/FSOdx7JwXB0dVGxBT6kvPkUfUKDkVpVYLS9Hl7iFLVlHfSubimn8rGJa
l/CStSymFbEiT9vPw8eGkosd5KH3a06wB9+wmoy4Z1dMA01mymTHE8siWYKf
RvYy8jFiNFtiqi3fVtP4gVtfr6D8VviiVLUTJlbTSEyzLBxXtzFNRRiOafTr
kniRV/y0jD+nil5ai2lKtmBM6xJe5orNJfVATCt6piopIKtkCiwDiUqRgZWN
vJg49m8y4p6Wi1NPoyrNfo5jNFP8xDIosCW713OA8XraXhmsEaPRkoo+FD1q
y7fVtOvAra9XUP6i8Nb+DFWOk5rWCBKk81gWjqujhXOV/RxF1XSmOCBPvslP
HXWapUXHwjWytYFWsgVjWlx4mggUNhH9MOK2+j2CmmfKrR8qd3A7mwLPkFZV
REdiWoQRw3LZ6vueCAJkRtChX5ySWFqyQfF6GRGKgzVuNHSTgtWWb6Vp14Fb
p0Nc/uKGb83+9oRJUNP9o/NYFr6rk1nwEW1z7O+7BjSFt/ddA+qjXKKmTuS0
jGPhGtmi+ko2WuPo1+UzPkLgotfYXuEjE2EEjmfKIzoy6spnThgwaryn0/Rw
pxrTZMSwI/LcOp8GIlx16QrCfvlIko2Ld4BRbbBGjGa7OdYoahrZnfT1Cspf
E8xKVTthEtdUOY9k0XR1e9RBtZCOtcMqSp3gaZlmhdNaqai+L1sTEeEjE2EK
rGd2fY8AQlJVkH4uEPADr80caQh+j4DrCV0xrQm7dahoTvwewX7o3H7t0I6F
bw2lafDQ8iCawkupIidMmgSt88gy7GpXZ17x0zJdZOPOMMKlKPzcieCg5pm9
3/dcHc0cRL7vSWVM/ERjV2LZZM1kuVFFhonjuDqMODFNaRo/tLwURfuPQzqP
ZbHO1Reps4hsL5fLBDTfM+/iTxMc+Lsc61ZbuwhOtOHSMNK1fM9NIW4Td+H8
d4TL2PNX8EwHV0wsD+AXH6xEIpFIJBKJRCKRSCQSiUQikUgkEolEIpFIJBKJ
RCKRSCQSiUQikUgkEolEIpFIJBKJRCKRSCQSiUQikUgkEolE4rrYts3eWXlh
XNsGiURiCS7/1xHf3t7s9fSfEvF7MBOJxDj8O6kPIDh5nUv91gWBC4QXRbzr
HswD9G8TdyFk4rqgK0HljdV0MxpdxjdO38Y0ul299/6R4LUsTpI2PQhMp0w3
RTo3N8mLJLruwWyi99abK+Iyt2lcHU1nSDh4enpSfgJjzloQi3la7z1x8evz
MDdrbjA3CCyibC+/kyhe+DXu+V23E14dF7v17OrwnSHh4HQ6KZeeeNFG7aL5
5l2oEvaa4BoilbTxy3BHKPvAWPj5krqYNXKBXVOXuHl7ccyMTVzsdtrroukM
iSIwKdQmHcw4cdUuxjR5yWlz1CBMcF1+PUM1qoQzeItlJN06RtkB3d/k94Hd
mEvwAjtfF2te1gtDI+9uPjC/fNaHGUkjKEhSNXYTMW6rmsARZ9hLhVyqhMgW
7lNk9PlKlPBntUxD/eKIbBXUJpRzqyMa6VN4ZnPgnJq/gkrSwIIKXEgLoSP+
G7/F0p+MI5QdQNNmYsNXIccvsPN1UealGQGaNLJUbgV9urG0Nwt1WI8wqt0H
TUUAUMOn0iZ2vLq0WKGCL/Aecwb0AdP9bGdix6PJ6zuEoT5oV4vXIrNcHbaY
VhuL3phWAxXT8It44CSBQlxxyYDZ7W6Ftb9N0hDiSBfi2HWLpR8HRig7kPUT
xyC9W8m+Lsq8kB+skboTa5ktcNnQFy/IOshorxwHskaAPLyoqUqUGi+HbBcG
VXAEti2WgtQFQQncVTkXxNGHwixzlBSsWT7H6aB1xbTaMVTYHwaUIw4b0pJE
a5aioyYdLS52CVNJGuggG2SOzSWPyDIgIT+rmN9LmTZ5LaymXD/xDdKMaXFd
9pJ5wZFTd5ktcC7hiBdnHWHkHAeyjXAAdl1ZibLj1TxlFByyQRVqAquWGgXo
opYMcJdGxqfog8Gi1dZWYpVZ1h0MuCSghSqm8TuUxaw8jRYgXqToaAevF3Zl
V5OOygLKB2ySJo+LyPJdcBlyEowi5X143ZervG+QpXkaceepIRWkikFzvOKs
m4zov8GYBpfg13/5aW28ppycHFGhJnCxJRLT1MLBMW0/j5Q6QGXNsu5gwCVB
mbNsoVfvIg7EtGIqS8ONRlomYEmuBhTPeBTraTRe/F+73UnFDdKROTrJj6Vf
+8hSnnK6mNbK7VzMdAzSDCMWzcBiX0nYPrx2kJ+Tpv54xVk3GdFHlkXRCJx1
qEqUHa8a2QM4rIIj8P7RGWoUYASmsJ/DoIpF+BUqpjER+WnNLPuM7fvrAiGF
004noB1AMZXlWUCHY6mq5s+R4r6nXMiKkiOCUQYC7ahnPLvY3cloKRMG58h2
PmNJ2aZjkK2+5VeDr6wyr1zmpJHxDPFURXokpkUYEYqlM2sEcoPtvWjP7YvG
a1AFR+D9ozM4FCizgmq0MbG/7xpQVra97xpQH2W0mlnGt+9vAYsKg7VUllcE
Ts4xCrxHU5wFxQNU7AmIjbUtGyjFJa/4TNwDB6skZZbH/5UmeAgcgzz3H83q
PZ8m6cvniHhdrJuMCNawvhGKx7pWjNc+oIJETeAIBdpzd1q4Qlu0mDLLlO37
XwHNVBbWplyRftoOxYPuaKQ6gH96jascXTEtArUzNfGbrTWDLDpC3/s9guZ4
zULxOFDRCFxKcmpBqqxaPGU0HTVeEYF9CrPAZpm1ff/pEU9l/dlhv5BIdQDY
31myqRCKn+gTzy4ikJSpZWJMI1iDrPtO0IHve17+L64QikagTSKnfmLH67po
CnwZ3JpZbh9zU1m7SPGZwwjWZReXWfdXZxR3cSrpLoRMfFbcZip7rewikUhc
AP8B93zF3w==
    "], {{0, 50}, {412, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  BaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{412, 50},
  PlotRange->{{0, 412}, {0, 50}}]], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Federpendel3", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Federpendel3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x10_", ",", "y10_", ",", "z10_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"vx10_", ",", "vy10_", ",", "vz10_"}], "}"}], ",", "m1_", ",", 
    "m2_", ",", "l01_", ",", "l02_", ",", "k1_", ",", "time_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "V", ",", "T", ",", "L", ",", "eq1", ",", "eq2", ",", "eq3", ",", "eq4", 
      ",", "eq5", ",", "eq6", ",", "inipos", ",", "inivel", ",", "sol", ",", 
      RowBox[{"g", "=", "9.81"}], ",", "q0", ",", "q1", ",", "q2"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "k1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"q0", "[", "t", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"q1", "[", "t", "]"}], "2"]}]], "-", "l01"}], ")"}], 
         "2"]}], "+", 
       RowBox[{"m1", " ", "g", " ", 
        RowBox[{"q1", "[", "t", "]"}]}], "+", 
       RowBox[{"m2", " ", "g", " ", 
        RowBox[{"q1", "[", "t", "]"}]}], "-", 
       RowBox[{"m2", " ", "g", " ", "l02", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"q0", "'"}], "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"q1", "'"}], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], "m2", " ", 
        SuperscriptBox["l02", "2"], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"q2", "'"}], "[", "t", "]"}], "2"]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{
         RowBox[{"q2", "'"}], "[", "t", "]"}], " ", "l02", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q0", "'"}], "[", "t", "]"}], 
           RowBox[{"Cos", "[", 
            RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"q1", "'"}], "[", "t", "]"}], 
           RowBox[{"Sin", "[", 
            RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"T", "-", "V"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"eq1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", 
               RowBox[{
                RowBox[{"q0", "'"}], "[", "t", "]"}]}], "]"}], ",", "t", ",", 
             " ", 
             RowBox[{"Constants", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
               "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1"}],
                "}"}]}]}], "]"}], "-", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", 
             RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}], "//",
          "FullSimplify"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"eq2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", 
               RowBox[{
                RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t", ",", 
             " ", 
             RowBox[{"Constants", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
               "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1"}],
                "}"}]}]}], "]"}], "-", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", 
             RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}], "//",
          "FullSimplify"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"eq3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", 
               RowBox[{
                RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}], ",", "t", ",", 
             " ", 
             RowBox[{"Constants", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{
               "m1", ",", "m2", ",", "l01", ",", "l02", ",", "g", ",", "k1"}],
                "}"}]}]}], "]"}], "-", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", 
             RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "\[Equal]", "0"}], "//",
          "FullSimplify"}]}]}], "}"}], ";", "\[IndentingNewLine]", 
     RowBox[{"inipos", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"q0", "[", "0", "]"}], "\[Equal]", "x10"}], ",", 
        RowBox[{
         RowBox[{"q1", "[", "0", "]"}], "\[Equal]", "y10"}], ",", 
        RowBox[{
         RowBox[{"q2", "[", "0", "]"}], "\[Equal]", "z10"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inivel", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"q0", "'"}], "[", "0", "]"}], "\[Equal]", "vx10"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"q1", "'"}], "[", "0", "]"}], "\[Equal]", "vy10"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"q2", "'"}], "[", "0", "]"}], "\[Equal]", "vz10"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eq1", ",", "eq2", ",", "eq3"}], "}"}], ",", "inipos", ",",
           "inivel"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q0", ",", "q1", ",", "q2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "time"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"Blue", ",", "\[IndentingNewLine]", 
             RowBox[{"Line", "@", 
              RowBox[{"spring", "[", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"q0", "[", "t", "]"}], ",", 
                RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], ",", 
             RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"q0", "[", "t", "]"}], ",", 
                  RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"q0", "[", "t", "]"}], "+", 
                   RowBox[{"l02", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"q1", "[", "t", "]"}], "-", 
                   RowBox[{"l02", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"q2", "[", "t", "]"}], "]"}]}]}]}], "}"}]}], 
               "}"}], "]"}], ",", "Red", ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"q0", "[", "t", "]"}], ",", 
                 RowBox[{"q1", "[", "t", "]"}]}], "}"}], ",", "0.6"}], "]"}], 
             ",", "Orange", ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"q0", "[", "t", "]"}], "+", 
                  RowBox[{"l02", " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"q1", "[", "t", "]"}], "-", 
                  RowBox[{"l02", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"q2", "[", "t", "]"}], "]"}]}]}]}], "}"}], ",", 
               "0.6"}], "]"}]}], "}"}], "/.", "sol"}], "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "8"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "time", ",", 
         FractionBox["time", "10000."]}], "}"}], ",", 
       RowBox[{"AnimationRate", "\[Rule]", "0.5"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.470116770915143*^9, 3.470117022983532*^9}, {
   3.4701171410057163`*^9, 3.470117161701749*^9}, {3.4701259327269187`*^9, 
   3.470125971502983*^9}, {3.470126675016073*^9, 3.470126687570093*^9}, {
   3.470126727852153*^9, 3.470126754346192*^9}, {3.4701267908302455`*^9, 
   3.470126794440251*^9}, {3.470126826982298*^9, 3.4701268333523064`*^9}, {
   3.47012688964039*^9, 3.470126891600393*^9}, 3.4701298517361574`*^9, {
   3.470129953382317*^9, 3.4701304279150696`*^9}, {3.4701304612751226`*^9, 
   3.4701304743391433`*^9}, {3.4701305069631977`*^9, 
   3.4701305118852053`*^9}, {3.4701307082575064`*^9, 3.470130826783682*^9}, {
   3.470130898289786*^9, 3.470130950453861*^9}, {3.4701310419139957`*^9, 
   3.4701310424039965`*^9}}],

Cell[BoxData[
 RowBox[{"Federpendel3", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "10", ",", "10", ",", "1", 
   ",", "3", ",", "100", ",", "100"}], "]"}]], "Input",
 CellChangeTimes->{{3.4701170498175716`*^9, 3.4701170865416317`*^9}, {
   3.470117198517824*^9, 3.4701172082778378`*^9}, 3.470126578239934*^9, 
   3.470126902430408*^9, {3.4701272806130414`*^9, 3.470127283953046*^9}, 
   3.4701304495511036`*^9, {3.4701304904551697`*^9, 3.4701305217552195`*^9}, {
   3.4701306471954136`*^9, 3.470130660309434*^9}, 3.47013084593571*^9}],

Cell["\<\
The van der Pol oscillator is a non-conservative oscillator with nonlinear \
damping and is an example of a stiff system of ordinary differential \
equations:\
\>", "Text",
 CellChangeTimes->{3.470023174625126*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vanDerPolSys", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "1", "]"}], "'"}], "[", "t", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "2", "]"}], "'"}], "[", "t", "]"}]}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{
             RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], "2"]}], ")"}], 
         RowBox[{
          RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", "2"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
     "}"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", 
     FractionBox["3", "1000"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4700233145273232`*^9, 3.4700233304173455`*^9}}],

Cell["Solution without any Options specified", "Text",
 CellChangeTimes->{{3.470023343879371*^9, 3.470023355819388*^9}}],

Cell[BoxData[
 RowBox[{"sol1", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{"vanDerPolSys", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "[", "1", "]"}], ",", 
      RowBox[{"y", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4700231818371377`*^9, 3.4700233346693583`*^9}, {
  3.470023394789442*^9, 3.470023396909446*^9}}],

Cell["Using Extrapolation method fails", "Text",
 CellChangeTimes->{{3.4700235913697176`*^9, 3.47002359985973*^9}}],

Cell[BoxData[
 RowBox[{"sol2", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{"vanDerPolSys", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "[", "1", "]"}], ",", 
      RowBox[{"y", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", "\"\<Extrapolation\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4700231818371377`*^9, 3.4700233346693583`*^9}, {
  3.4700233683394055`*^9, 3.470023401469452*^9}}],

Cell["\<\
Solve the system using a method that switches when stiffness occurs.\
\>", "Text",
 CellChangeTimes->{3.4700233904994364`*^9}],

Cell[BoxData[
 RowBox[{"sol3", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{"vanDerPolSys", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y", "[", "1", "]"}], ",", 
      RowBox[{"y", "[", "2", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", " ", 
    RowBox[{"Method", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<StiffnessSwitching\>\"", ",", 
       RowBox[{"\"\<NonstiffTest\>\"", "->", "False"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4700231818371377`*^9, 3.4700233346693583`*^9}, {
  3.4700233683394055`*^9, 3.4700234148594704`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}], "}"}], "/.", 
       "sol1"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "10"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "Red", "}"}], ",", " ", 
        RowBox[{"{", "Blue", "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
     RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}], "}"}], "/.", 
       "sol2"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "10"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "Red", "}"}], ",", " ", 
        RowBox[{"{", "Blue", "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
     RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", "1", "]"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"y", "[", "2", "]"}], "[", "t", "]"}]}], "}"}], "/.", 
       "sol3"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "10"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "Red", "}"}], ",", " ", 
        RowBox[{"{", "Blue", "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
     RowBox[{"Frame", " ", "->", " ", "True"}]}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.4700234350994987`*^9, 3.4700235581496716`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", " ", 
       RowBox[{"y", "[", "t", "]"}]}], "}"}], " ", "/.", "\n", "         ", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"x", "''"}], "[", "t", "]"}], " ", "==", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "300"}], " ", 
            RowBox[{"x", "[", "t", "]"}]}], " ", "+", " ", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{"y", "[", "t", "]"}]}], ")"}]}]}]}], ",", "\n", 
         "                  ", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "'"}], "[", "t", "]"}], " ", "==", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "t"}], " ", 
            RowBox[{"y", "[", "t", "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"x", "[", "t", "]"}], " ", 
            RowBox[{"y", "[", "t", "]"}]}]}]}], ",", "\n", 
         "                  ", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], " ", "==", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "'"}], "[", "0", "]"}], " ", "==", " ", "0"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"y", "[", "0", "]"}], " ", "==", " ", "1"}]}], "}"}], ",", 
       "\n", "                  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], ",", " ", 
         RowBox[{"y", "[", "t", "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", "0", ",", " ", "4"}], "}"}]}], "]"}]}], "]"}], 
   ",", "\n", "     ", 
   RowBox[{"{", 
    RowBox[{"t", ",", " ", "0", ",", " ", "4"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "->", " ", "All"}]}], "]"}]], "Input"],

Cell["\<\
NDSolve accepts a number of options to control the solution process.\
\>", "Text",
 CellChangeTimes->{{3.4700407401226225`*^9, 3.4700407595626497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "NDSolve", "]"}]], "Input",
 CellChangeTimes->{{3.470040764294657*^9, 3.4700408524527855`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"AccuracyGoal", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Compiled", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"DependentVariables", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"EvaluationMonitor", "\[Rule]", "None"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"MaxStepFraction", "\[Rule]", 
    FractionBox["1", "10"]}], ",", 
   RowBox[{"MaxSteps", "\[Rule]", "10000"}], ",", 
   RowBox[{"MaxStepSize", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Method", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"NormFunction", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PrecisionGoal", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"SolveDelayed", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"StartingStepSize", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"StepMonitor", "\[Rule]", "None"}], ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
  "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.470040852802786*^9, 3.472235318009309*^9}]
}, Open  ]],

Cell["Some of the options can also take sub-option settings", "Text",
 CellChangeTimes->{{3.472205948657709*^9, 3.4722059612469316`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "NDSolve`ExplicitRungeKutta", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Coefficients\"\>", 
    "\[Rule]", "\<\"EmbeddedExplicitRungeKuttaCoefficients\"\>"}], ",", 
   RowBox[{"\<\"DifferenceOrder\"\>", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"\<\"EmbeddedDifferenceOrder\"\>", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"\<\"StepSizeControlParameters\"\>", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"\<\"StepSizeRatioBounds\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "8"], ",", "4"}], "}"}]}], ",", 
   RowBox[{"\<\"StepSizeSafetyFactors\"\>", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"\<\"StiffnessTest\"\>", "\[Rule]", "Automatic"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.470040777556677*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Excercise", "Subsubsection",
 CellChangeTimes->{{3.472233132008803*^9, 3.4722331333488045`*^9}}],

Cell[TextData[StyleBox["Find a numeric solution to the following pendulum \
plus visualization:",
 FontColor->RGBColor[0, 0, 1]]], "Text",
 CellChangeTimes->{{3.4722337596792936`*^9, 3.4722337742310543`*^9}, {
  3.4722340024691067`*^9, 3.472234007302743*^9}},
 FontWeight->"Bold"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Black", ",", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "5"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "5"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(1\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1.5", ",", 
         RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(2\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.4"}], ",", 
         RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "Black", ",", "Thick", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4722338143106136`*^9, 3.4722339787306767`*^9}}],

Cell[BoxData[
 GraphicsBox[
  {GrayLevel[0], PointSize[0.05], PointBox[{1, -5}], 
   {PointSize[0.05], PointBox[{-1, -5}], 
    LineBox[{{0, 0}, {1, -5}, {-1, -5}, {0, 0}}], 
    InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)\"\>", {1.5, -5}],
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(2\\)]\\)\"\>", \
{-1.4, -5}], 
    {GrayLevel[0], Thickness[Large], LineBox[{{-3, 0}, {3, 0}}]}}},
  Frame->False]], "Output",
 CellChangeTimes->{
  3.4722339115459642`*^9, {3.4722339624162064`*^9, 3.4722339791691847`*^9}}]
}, Open  ]],

Cell[TextData[StyleBox["Find a numeric solution to the following pendulum \
plus visualization:",
 FontColor->RGBColor[0, 0, 1]]], "Text",
 CellChangeTimes->{{3.4722337596792936`*^9, 3.4722337742310543`*^9}, {
  3.4722340024691067`*^9, 3.472234007302743*^9}},
 FontWeight->"Bold"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Black", ",", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "5"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "5"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "5"}]}], "}"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Blue", ",", 
     RowBox[{"Line", "@", 
      RowBox[{"spring", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "5"}], ",", "1", ",", 
        RowBox[{"-", "5"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(1\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1.5", ",", 
         RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(2\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.4"}], ",", 
         RowBox[{"-", "5"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "Black", ",", "Thick", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4722338143106136`*^9, 3.4722339787306767`*^9}, {
  3.472234037682063*^9, 3.4722340758452225`*^9}}],

Cell[BoxData[
 GraphicsBox[
  {GrayLevel[0], PointSize[0.05], PointBox[{1, -5}], 
   {PointSize[0.05], PointBox[{-1, -5}], LineBox[{{-1, -5}, {0, 0}, {1, -5}}], 
    {RGBColor[0, 0, 1], 
     LineBox[{{-1, -5}, {-0.6533333333333333, -5}, {-0.6066666666666667, \
-4.8}, {-0.56, -5.2}, {-0.5133333333333334, -4.8}, {-0.4666666666666667, \
-5.2}, {-0.42000000000000004`, -4.8}, {-0.3733333333333333, -5.2}, \
{-0.32666666666666666`, -4.8}, {-0.28, -5.2}, {-0.2333333333333334, -4.8}, \
{-0.18666666666666676`, -5.2}, {-0.14000000000000012`, -4.8}, \
{-0.09333333333333349, -5.2}, {-0.046666666666666634`, -4.8}, {0., -5.2}, {
       0.046666666666666634`, -4.8}, {0.09333333333333327, -5.2}, {
       0.1399999999999999, -4.8}, {0.18666666666666654`, -5.2}, {
       0.23333333333333317`, -4.8}, {0.2799999999999998, -5.2}, {
       0.32666666666666666`, -4.8}, {0.3733333333333333, -5.2}, {
       0.41999999999999993`, -4.8}, {0.46666666666666656`, -5.2}, {
       0.5133333333333332, -4.8}, {0.5599999999999998, -5.2}, {
       0.6066666666666667, -4.8}, {0.6533333333333333, -5}, {1, -5}}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)\"\>", \
{1.5, -5}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(2\\)]\\)\"\>", \
{-1.4, -5}]}, 
    {GrayLevel[0], Thickness[Large], LineBox[{{-3, 0}, {3, 0}}]}}},
  Frame->False]], "Output",
 CellChangeTimes->{
  3.4722339115459642`*^9, {3.4722339624162064`*^9, 3.4722339791691847`*^9}, {
   3.4722340417798157`*^9, 3.4722340760902233`*^9}}]
}, Open  ]],

Cell["\<\
Find a numeric solution of the following system of masses connected with \
springs and visualize the solution.\
\>", "Text",
 CellChangeTimes->{{3.4722331365518494`*^9, 3.472233170357253*^9}, {
  3.472233635596388*^9, 3.472233655132362*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Black", ",", 
     RowBox[{"Line", "@", 
      RowBox[{"spring", "[", 
       RowBox[{"0", ",", "2", ",", "1", ",", "0"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "Red", ",", 
     RowBox[{"Line", "@", 
      RowBox[{"spring", "[", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "Blue", ",", 
     RowBox[{"Line", "@", 
      RowBox[{"spring", "[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "2"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "Black", ",", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", "Red", ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     "Blue", ",", 
     RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", "Black", ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(12\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0.8", ",", "1.2"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(23\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", ".3"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(k\), \(31\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.8"}], ",", "1.2"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(1\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2.2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(2\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Text", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(3\)]\)\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.2"}], ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4699703578160915`*^9, 3.469970607408797*^9}, {
   3.4699707323249764`*^9, 3.4699707359849815`*^9}, {3.469970794187064*^9, 
   3.469970868733181*^9}, {3.4699709434972887`*^9, 3.4699709705573263`*^9}, 
   3.4722059172236543`*^9, {3.472233177218703*^9, 3.4722335767607245`*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], 
    LineBox[{{0, 2}, {0.15855314007332155`, 1.682893719853357}, {
      0.3618276396966389, 1.72355831610668}, {0.0284458247200067, 
      1.4958947550600286`}, {0.4106057625433072, 1.6260020704133435`}, {
      0.07722394756667503, 1.398338509366692}, {0.45938388538997554`, 
      1.5284458247200068`}, {0.12600207041334346`, 1.300782263673355}, {
      0.5081620082366439, 1.43088957902667}, {0.1747801932600118, 
      1.2032260179800185`}, {0.5569401310833123, 1.3333333333333335`}, {
      0.22355831610668012`, 1.105669772286682}, {0.6057182539299806, 
      1.2357770876399967`}, {0.27233643895334836`, 1.0081135265933452`}, {
      0.6544963767766491, 1.13822084194666}, {0.32111456180001685`, 
      0.9105572809000084}, {0.7032744996233173, 1.0406645962533232`}, {
      0.36989268464668523`, 0.8130010352066717}, {0.7520526224699856, 
      0.9431083505599867}, {0.4186708074933535, 0.7154447895133351}, {
      0.800830745316654, 0.8455521048666499}, {0.4674489303400219, 
      0.6178885438199984}, {0.8496088681633224, 0.7479958591733131}, {
      0.5162270531866903, 0.5203322981266616}, {0.8983869910099908, 
      0.6504396134799764}, {0.5650051760333585, 0.42277605243332506`}, {
      0.947165113856659, 0.5528833677866398}, {0.6137832988800269, 
      0.3252198067399883}, {0.9959432367033274, 0.45532712209330306`}, {
      0.8414468599266784, 0.3171062801466431}, {1, 0}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{1, 0}, {0.6533333333333333, 0}, {0.6066666666666667, -0.2}, {
      0.56, 0.2}, {0.5133333333333334, -0.2}, {0.4666666666666667, 0.2}, {
      0.42000000000000004`, -0.2}, {0.3733333333333333, 0.2}, {
      0.32666666666666666`, -0.2}, {0.28, 0.2}, {0.2333333333333334, -0.2}, {
      0.18666666666666676`, 0.2}, {0.14000000000000012`, -0.2}, {
      0.09333333333333349, 0.2}, {0.046666666666666634`, -0.2}, {0., 
      0.2}, {-0.046666666666666634`, -0.2}, {-0.09333333333333327, 
      0.2}, {-0.1399999999999999, -0.2}, {-0.18666666666666654`, 
      0.2}, {-0.23333333333333317`, -0.2}, {-0.2799999999999998, 
      0.2}, {-0.32666666666666666`, -0.2}, {-0.3733333333333333, 
      0.2}, {-0.41999999999999993`, -0.2}, {-0.46666666666666656`, 
      0.2}, {-0.5133333333333332, -0.2}, {-0.5599999999999998, 
      0.2}, {-0.6066666666666667, -0.2}, {-0.6533333333333333, 0}, {-1, 0}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{-1, 0}, {-0.8414468599266784, 
      0.3171062801466431}, {-0.9959432367033274, 
      0.455327122093303}, {-0.6137832988800269, 
      0.3252198067399882}, {-0.9471651138566591, 
      0.5528833677866397}, {-0.5650051760333586, 
      0.42277605243332483`}, {-0.8983869910099908, 
      0.6504396134799764}, {-0.5162270531866902, 
      0.5203322981266617}, {-0.8496088681633224, 
      0.7479958591733131}, {-0.4674489303400219, 
      0.6178885438199984}, {-0.8008307453166541, 
      0.8455521048666498}, {-0.4186708074933536, 
      0.715444789513335}, {-0.7520526224699857, 
      0.9431083505599864}, {-0.36989268464668523`, 
      0.8130010352066716}, {-0.7032744996233173, 
      1.0406645962533234`}, {-0.32111456180001685`, 
      0.9105572809000084}, {-0.654496376776649, 
      1.13822084194666}, {-0.27233643895334847`, 
      1.0081135265933452`}, {-0.6057182539299807, 
      1.2357770876399965`}, {-0.22355831610668017`, 
      1.1056697722866817`}, {-0.5569401310833123, 
      1.3333333333333333`}, {-0.1747801932600118, 
      1.2032260179800185`}, {-0.5081620082366439, 
      1.43088957902667}, {-0.1260020704133434, 
      1.3007822636733553`}, {-0.45938388538997554`, 
      1.5284458247200068`}, {-0.07722394756667514, 
      1.3983385093666918`}, {-0.4106057625433073, 
      1.6260020704133433`}, {-0.028445824720006757`, 
      1.4958947550600286`}, {-0.3618276396966389, 
      1.72355831610668}, {-0.15855314007332155`, 1.682893719853357}, {0, 
      2}}]}, 
   {GrayLevel[0], PointSize[0.05], PointBox[{0, 2}]}, 
   {RGBColor[1, 0, 0], PointSize[0.05], PointBox[{1, 0}]}, 
   {RGBColor[0, 0, 1], PointSize[0.05], PointBox[{-1, 0}], 
    {GrayLevel[0], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(k\\), \\(12\\)]\\)\"\>", \
{0.8, 1.2}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(k\\), \\(23\\)]\\)\"\>", {0, 0.3}]
      , InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(k\\), \\(31\\)]\\)\"\>", \
{-0.8, 1.2}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(1\\)]\\)\"\>", {0, 2.2}],
      InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(2\\)]\\)\"\>", \
{1.2, 0}], 
     InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(3\\)]\\)\"\>", \
{-1.2, 0}]}}},
  Frame->False]], "Output",
 CellChangeTimes->{{3.4722333236631956`*^9, 3.472233362986126*^9}, {
  3.472233469609029*^9, 3.472233577120745*^9}}]
}, Open  ]],

Cell["\<\
Generalize the above problem to any given n-gon and write a program to solve \
it and show the solution.\
\>", "Text",
 CellChangeTimes->{{3.472233701712309*^9, 3.472233732365141*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical Solution to PDE'S", "Subsection",
 CellChangeTimes->{{3.470023752121944*^9, 3.4700237537119465`*^9}}],

Cell[TextData[{
 "Required Reading:\n\n",
 ButtonBox["Numerical Solution of Partial Differential Equations",
  BaseStyle->"Link",
  ButtonData->"paclet:tutorial/NDSolvePDE"]
}], "Text",
 CellChangeTimes->{{3.471941236037241*^9, 3.471941250904067*^9}}],

Cell[TextData[{
 ButtonBox["NDSolve",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/NDSolve"],
 " currently uses the numerical method of lines (1+1 dimensions) to compute \
solutions to partial differential equations. The numerical method of lines is \
a technique for solving partial differential equations by discretizing in all \
but one dimension, and then integrating the semi-discrete problem as a system \
of ODEs or DAEs. The method is restricted to problems that can be posed with \
an initial condition\nin at least one independent variable. For example, the \
method cannot solve elliptic PDEs such\nas Laplace's equation because these \
require boundary values. For the problems it does solve,\nthe method of lines \
is quite general, handling systems of PDEs or nonlinearity well, and often\n\
quite fast."
}], "Text",
 CellChangeTimes->{{3.470040402111657*^9, 3.470040408791667*^9}, {
   3.4719408682353945`*^9, 3.4719408733522043`*^9}, 3.471940947421134*^9, {
   3.47194099638962*^9, 3.471941018354459*^9}}],

Cell[TextData[{
 "This solves the heat equation in 1 dimension. A ",
 "Simple model for soil temperature at depth ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula"],
 " with periodic heating at the surface:"
}], "Text",
 CellChangeTimes->{{3.4719471348287773`*^9, 3.471947152456808*^9}}],

Cell[BoxData[{
 RowBox[{"NDSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}], ",", "x", ",", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"0", ",", "x"}], "]"}], "==", "0"}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "0"}], "]"}], "==", 
      RowBox[{"Sin", "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "5"}], "]"}], "==", "0"}]}], "}"}], ",", "u", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "5"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"t", ",", "x"}], "]"}], "/.", "%"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"Hue", "[", 
       RowBox[{".65", 
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}]}], "]"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.471944423697098*^9, 3.471944465333571*^9}, {
   3.471944527967681*^9, 3.4719446050318165`*^9}, {3.471944647697891*^9, 
   3.471944647978692*^9}, {3.4719465012492647`*^9, 3.471946501467665*^9}, {
   3.471946576597397*^9, 3.471946632757496*^9}, {3.471946687451192*^9, 
   3.4719467105860324`*^9}, {3.471946741723687*^9, 3.471946790192972*^9}, {
   3.4719468384750566`*^9, 3.471946863559901*^9}, 3.4719469497656527`*^9, {
   3.4719470187177734`*^9, 3.471947060775448*^9}}],

Cell["\<\
Simple wave evolution with periodic boundary conditions, The wave \
\>", "Text",
 CellChangeTimes->{
  3.471947180989259*^9, {3.471947371247193*^9, 3.4719473834776144`*^9}}],

Cell[BoxData[{
 RowBox[{"s", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"t", ",", "t"}]], 
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}]}], "\[Equal]", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"x", ",", "x"}]], 
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         SuperscriptBox["x", "2"]}]]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["u", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"0", ",", "x"}], "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"t", ",", 
         RowBox[{"-", "10"}]}], "]"}], "\[Equal]", 
       RowBox[{"u", "[", 
        RowBox[{"t", ",", "10"}], "]"}]}]}], "}"}], ",", "u", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "40"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "10"}], ",", "10"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"First", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "/.", "\[InvisibleSpace]", "s"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "40"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", "Automatic"}]}], "]"}], ",", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"First", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "/.", "\[InvisibleSpace]", "s"}], 
       "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "40"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "30"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]}], 
  "}"}]}], "Input",
 CellChangeTimes->{{3.471946670899563*^9, 3.471946686078389*^9}, {
  3.4719471873540697`*^9, 3.4719472812818346`*^9}}],

Cell["\<\
This finds a numerical solution to a generalization of the nonlinear \
sine-Gordon equation to two
spatial dimensions with periodic boundary conditions.\
\>", "Text",
 CellChangeTimes->{3.470040457845738*^9}],

Cell[BoxData[
 RowBox[{"NDSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", "t", ",", "t"}], 
       "]"}], " ", "==", "\n", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", "x", ",", "x"}], 
        "]"}], "+", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", "y", ",", "y"}], 
        "]"}], "-", 
       RowBox[{"Sin", "[", 
        RowBox[{"u", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "[", "u", "]"}], "[", 
       RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", "0"}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"t", ",", 
        RowBox[{"-", "5"}], ",", "y"}], "]"}], " ", "==", " ", 
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "5", ",", "y"}], "]"}], " ", "==", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "x", ",", 
        RowBox[{"-", "5"}]}], "]"}], "==", " ", 
      RowBox[{"u", "[", 
       RowBox[{"t", ",", "x", ",", "5"}], "]"}], " ", "==", " ", "0"}]}], 
    "}"}], ",", "u", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4700404801877704`*^9, 3.4700406271099772`*^9}}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"First", "[", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"3", ",", "x", ",", "y"}], "]"}], "/.", "%"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.4700406542924957`*^9}],

Cell[CellGroupData[{

Cell["Excercise", "Subsubsection",
 CellChangeTimes->{3.472234497114767*^9}],

Cell[TextData[{
 "Consider the 2-dim heat equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "(", 
     RowBox[{"x", ",", "y", ",", "t"}], ")"}], "\[LongEqual]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "(", 
      RowBox[{"x", ",", "y", ",", "t"}], ")"}], "+", 
     RowBox[{
      SuperscriptBox["u", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "(", 
      RowBox[{"x", ",", "y", ",", "t"}], ")"}]}]}], TraditionalForm]],
  CellChangeTimes->{3.4722345394761*^9}],
 ". Solve it numerically for -1\[LessEqual]x\[LessEqual]1 and -1\[LessEqual]y\
\[LessEqual]1and assume the following boundary conditions T->0 at the esges. \
The initial temperature condition at  t=0 is  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Piecewise]", GridBox[{
      {"1", 
       RowBox[{
        FractionBox["1", "4"], "<", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], "<", 
        FractionBox["1", "2"]}]},
      {"0", 
       TagBox["True",
        "PiecewiseDefault",
        AutoDelete->False,
        DeletionWarning->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.84]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}]}], TraditionalForm]],
  CellChangeTimes->{3.4722346879710193`*^9}],
 " (use: Piecewise[{{1, 1/4 < x^2 + y^2 < 1/2}}]). Visualize the temperature \
conditions for different times t."
}], "Text",
 CellChangeTimes->{{3.472234507455573*^9, 3.4722347479081063`*^9}},
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"1", "/", "4"}], "<", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "<", 
        RowBox[{"1", "/", "1.5"}]}]}], "}"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4722344907495823`*^9, 3.4722345011425743`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{702, 731},
WindowMargins->{{7, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (February 18, 2009)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "b:0.0"->{
  Cell[3317, 101, 701, 22, 61, "Item",
   CellTags->"b:0.0",
   CellID->6493],
  Cell[4021, 125, 532, 14, 77, "Item",
   CellTags->"b:0.0",
   CellID->1515],
  Cell[4556, 141, 536, 13, 77, "Item",
   CellTags->"b:0.0",
   CellID->25269]},
 "b:3.0"->{
  Cell[63758, 2113, 297, 11, 29, "Text",
   CellTags->"b:3.0",
   CellID->6021]},
 "b:3.1"->{
  Cell[65040, 2156, 79, 2, 29, "Text",
   CellTags->"b:3.1",
   CellID->28289],
  Cell[65122, 2160, 163, 5, 41, "Input",
   CellTags->"b:3.1",
   CellID->15944]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"b:0.0", 232288, 6917},
 {"b:3.0", 232539, 6927},
 {"b:3.1", 232633, 6931}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 187, 5, 127, "Title"],
Cell[757, 29, 604, 13, 126, "Subtitle"],
Cell[CellGroupData[{
Cell[1386, 46, 106, 1, 75, "Section"],
Cell[1495, 49, 640, 16, 119, "Text"],
Cell[2138, 67, 1154, 30, 101, "Text"],
Cell[CellGroupData[{
Cell[3317, 101, 701, 22, 61, "Item",
 CellTags->"b:0.0",
 CellID->6493],
Cell[4021, 125, 532, 14, 77, "Item",
 CellTags->"b:0.0",
 CellID->1515],
Cell[4556, 141, 536, 13, 77, "Item",
 CellTags->"b:0.0",
 CellID->25269]
}, Open  ]],
Cell[CellGroupData[{
Cell[5129, 159, 142, 2, 36, "Subsection"],
Cell[5274, 163, 264, 6, 65, "Text"],
Cell[5541, 171, 1608, 59, 82, "Text"],
Cell[7152, 232, 565, 14, 29, "Text"],
Cell[7720, 248, 300, 8, 41, "Input"],
Cell[8023, 258, 295, 10, 29, "Text"],
Cell[8321, 270, 330, 10, 41, "Input"],
Cell[8654, 282, 414, 7, 47, "Text"],
Cell[9071, 291, 475, 13, 41, "Input"],
Cell[9549, 306, 524, 14, 41, "Input"],
Cell[10076, 322, 343, 9, 47, "Text"],
Cell[10422, 333, 590, 14, 41, "Input"],
Cell[11015, 349, 1566, 35, 164, "Text"],
Cell[12584, 386, 1447, 52, 53, "Text"],
Cell[14034, 440, 424, 12, 41, "Input"],
Cell[14461, 454, 260, 5, 29, "Text"],
Cell[14724, 461, 545, 16, 41, "Input"],
Cell[15272, 479, 223, 4, 47, "Text"],
Cell[15498, 485, 1085, 33, 120, "Input"],
Cell[16586, 520, 419, 12, 29, "Text"],
Cell[17008, 534, 445, 10, 43, "Input"],
Cell[17456, 546, 538, 13, 43, "Input"],
Cell[17997, 561, 390, 13, 47, "Text"],
Cell[18390, 576, 439, 13, 41, "Input"],
Cell[18832, 591, 478, 14, 43, "Input"],
Cell[19313, 607, 705, 19, 41, "Input"],
Cell[20021, 628, 501, 15, 41, "Input"],
Cell[20525, 645, 708, 18, 83, "Text"],
Cell[21236, 665, 422, 12, 41, "Input"],
Cell[21661, 679, 447, 13, 41, "Input"],
Cell[22111, 694, 238, 4, 47, "Text"],
Cell[22352, 700, 313, 10, 41, "Input"],
Cell[22668, 712, 191, 4, 29, "Text"],
Cell[22862, 718, 313, 10, 41, "Input"],
Cell[23178, 730, 316, 9, 47, "Text"],
Cell[23497, 741, 160, 3, 29, "Text"],
Cell[23660, 746, 755, 23, 62, "Input"],
Cell[24418, 771, 178, 4, 29, "Text"],
Cell[24599, 777, 453, 13, 41, "Input"],
Cell[25055, 792, 513, 13, 47, "Text"],
Cell[25571, 807, 405, 11, 41, "Input"],
Cell[25979, 820, 701, 17, 83, "Text"],
Cell[26683, 839, 994, 32, 65, "Input"],
Cell[27680, 873, 709, 22, 65, "Text"],
Cell[28392, 897, 518, 15, 41, "Input"],
Cell[28913, 914, 559, 10, 83, "Text"],
Cell[29475, 926, 317, 9, 41, "Input"],
Cell[29795, 937, 592, 19, 43, "Input"],
Cell[30390, 958, 402, 13, 56, "Input"],
Cell[30795, 973, 126, 3, 29, "Text"],
Cell[30924, 978, 323, 10, 41, "Input"],
Cell[31250, 990, 402, 13, 55, "Input"],
Cell[31655, 1005, 129, 3, 29, "Text"],
Cell[31787, 1010, 778, 23, 41, "Input"],
Cell[32568, 1035, 971, 28, 62, "Input"],
Cell[33542, 1065, 1610, 48, 102, "Input"],
Cell[35155, 1115, 111, 1, 29, "Text"],
Cell[35269, 1118, 758, 23, 62, "Input"],
Cell[36030, 1143, 936, 29, 62, "Input"],
Cell[CellGroupData[{
Cell[36991, 1176, 104, 1, 27, "Subsubsection"],
Cell[37098, 1179, 556, 22, 29, "Text"],
Cell[37657, 1203, 534, 15, 47, "Text"],
Cell[38194, 1220, 318, 13, 33, "Text"],
Cell[38515, 1235, 284, 11, 31, "Text"],
Cell[38802, 1248, 540, 17, 29, "Text"],
Cell[39345, 1267, 792, 24, 58, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40186, 1297, 118, 1, 36, "Subsection"],
Cell[40307, 1300, 634, 19, 47, "Text"],
Cell[40944, 1321, 607, 19, 61, "Input"],
Cell[41554, 1342, 442, 10, 65, "Text"],
Cell[41999, 1354, 446, 15, 41, "Input"],
Cell[42448, 1371, 106, 1, 29, "Text"],
Cell[42557, 1374, 123, 3, 41, "Input"],
Cell[42683, 1379, 321, 9, 47, "Text"],
Cell[43007, 1390, 897, 31, 47, "Text"],
Cell[43907, 1423, 351, 12, 41, "Input"],
Cell[44261, 1437, 105, 3, 29, "Text"],
Cell[44369, 1442, 622, 19, 41, "Input"],
Cell[44994, 1463, 325, 9, 47, "Text"],
Cell[45322, 1474, 500, 17, 41, "Input"],
Cell[45825, 1493, 315, 8, 47, "Text"],
Cell[46143, 1503, 682, 24, 49, "DisplayFormula",
 CellID->10440],
Cell[46828, 1529, 525, 18, 47, "Text"],
Cell[47356, 1549, 424, 11, 47, "Text"],
Cell[47783, 1562, 491, 17, 41, "Input"],
Cell[48277, 1581, 221, 6, 41, "Input"],
Cell[48501, 1589, 267, 7, 29, "Text"],
Cell[48771, 1598, 702, 20, 41, "Input"],
Cell[49476, 1620, 1642, 57, 83, "Text"],
Cell[51121, 1679, 204, 4, 47, "Text"],
Cell[51328, 1685, 512, 15, 41, "Input"],
Cell[51843, 1702, 130, 1, 29, "Text"],
Cell[51976, 1705, 473, 15, 41, "Input"],
Cell[52452, 1722, 884, 27, 59, "Text"],
Cell[53339, 1751, 646, 21, 41, "Input"],
Cell[53988, 1774, 329, 7, 47, "Text"],
Cell[54320, 1783, 307, 9, 41, "Input"],
Cell[54630, 1794, 359, 11, 40, "Text"],
Cell[54992, 1807, 544, 18, 41, "Input"],
Cell[55539, 1827, 248, 5, 47, "Text"],
Cell[55790, 1834, 407, 13, 58, "Input"],
Cell[56200, 1849, 318, 10, 47, "Text"],
Cell[56521, 1861, 470, 15, 58, "Input"],
Cell[56994, 1878, 117, 1, 29, "Text"],
Cell[57114, 1881, 144, 3, 41, "Input"],
Cell[57261, 1886, 754, 22, 65, "Text"],
Cell[58018, 1910, 131, 4, 41, "Input"],
Cell[58152, 1916, 239, 6, 41, "Input"],
Cell[58394, 1924, 121, 1, 29, "Text"],
Cell[58518, 1927, 694, 21, 41, "Input"],
Cell[CellGroupData[{
Cell[59237, 1952, 103, 1, 27, "Subsubsection"],
Cell[59343, 1955, 917, 35, 34, "Text"],
Cell[60263, 1992, 335, 12, 32, "Text"],
Cell[60601, 2006, 733, 24, 39, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61383, 2036, 150, 2, 36, "Subsection"],
Cell[61536, 2040, 424, 7, 83, "Text"],
Cell[61963, 2049, 682, 21, 47, "Text"],
Cell[62648, 2072, 943, 34, 41, "Input"],
Cell[63594, 2108, 161, 3, 29, "Text"],
Cell[63758, 2113, 297, 11, 29, "Text",
 CellTags->"b:3.0",
 CellID->6021],
Cell[64058, 2126, 471, 13, 47, "Text"],
Cell[64532, 2141, 269, 5, 47, "Text"],
Cell[64804, 2148, 233, 6, 41, "Input"],
Cell[65040, 2156, 79, 2, 29, "Text",
 CellTags->"b:3.1",
 CellID->28289],
Cell[65122, 2160, 163, 5, 41, "Input",
 CellTags->"b:3.1",
 CellID->15944]
}, Open  ]],
Cell[CellGroupData[{
Cell[65322, 2170, 131, 1, 36, "Subsection"],
Cell[65456, 2173, 247, 6, 65, "Text"],
Cell[65706, 2181, 370, 11, 47, "Text"],
Cell[66079, 2194, 548, 20, 29, "Text"],
Cell[66630, 2216, 142, 1, 29, "Text"],
Cell[66775, 2219, 366, 10, 41, "Input"],
Cell[67144, 2231, 448, 13, 41, "Input"],
Cell[67595, 2246, 176, 4, 29, "Text"],
Cell[67774, 2252, 333, 9, 41, "Input"],
Cell[68110, 2263, 225, 5, 29, "Text"],
Cell[68338, 2270, 616, 17, 41, "Input"],
Cell[68957, 2289, 103, 1, 29, "Text"],
Cell[69063, 2292, 238, 8, 41, "Input"],
Cell[69304, 2302, 86, 1, 29, "Text"],
Cell[69393, 2305, 534, 17, 41, "Input"],
Cell[69930, 2324, 76, 1, 29, "Text"],
Cell[70009, 2327, 330, 10, 41, "Input"],
Cell[70342, 2339, 301, 7, 47, "Text"],
Cell[70646, 2348, 581, 18, 41, "Input"],
Cell[71230, 2368, 231, 4, 47, "Text"],
Cell[71464, 2374, 629, 18, 41, "Input"],
Cell[72096, 2394, 167, 3, 29, "Text"],
Cell[72266, 2399, 422, 12, 41, "Input"],
Cell[72691, 2413, 118, 1, 29, "Text"],
Cell[72812, 2416, 288, 8, 41, "Input"],
Cell[73103, 2426, 101, 1, 29, "Text"],
Cell[73207, 2429, 597, 19, 41, "Input"],
Cell[73807, 2450, 83, 1, 29, "Text"],
Cell[73893, 2453, 685, 21, 62, "Input"],
Cell[74581, 2476, 78, 1, 29, "Text"],
Cell[74662, 2479, 483, 14, 62, "Input"],
Cell[75148, 2495, 455, 17, 29, "Text"],
Cell[75606, 2514, 460, 15, 41, "Input"],
Cell[76069, 2531, 259, 8, 29, "Text"],
Cell[76331, 2541, 440, 14, 41, "Input"],
Cell[76774, 2557, 422, 15, 29, "Text"],
Cell[77199, 2574, 688, 21, 62, "Input"],
Cell[77890, 2597, 320, 10, 41, "Input"],
Cell[78213, 2609, 585, 19, 65, "Text"],
Cell[78801, 2630, 259, 8, 41, "Input"],
Cell[79063, 2640, 384, 12, 41, "Input"],
Cell[79450, 2654, 346, 10, 41, "Input"],
Cell[79799, 2666, 476, 8, 47, "Text"],
Cell[80278, 2676, 636, 19, 62, "Input"],
Cell[80917, 2697, 366, 10, 31, "Text"],
Cell[81286, 2709, 2018, 77, 101, "Text"],
Cell[CellGroupData[{
Cell[83329, 2790, 103, 1, 27, "Subsubsection"],
Cell[83435, 2793, 179, 3, 29, "Text"],
Cell[83617, 2798, 352, 10, 47, "Text"],
Cell[83972, 2810, 293, 7, 29, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84314, 2823, 109, 1, 36, "Subsection"],
Cell[84426, 2826, 390, 9, 83, "Text"],
Cell[84819, 2837, 438, 10, 47, "Text"],
Cell[85260, 2849, 1074, 34, 71, "Text"],
Cell[86337, 2885, 553, 11, 83, "Text"],
Cell[86893, 2898, 82, 1, 29, "Text"],
Cell[86978, 2901, 63, 1, 41, "Input"],
Cell[87044, 2904, 1792, 59, 83, "Text"],
Cell[88839, 2965, 96, 1, 29, "Text"],
Cell[88938, 2968, 285, 8, 41, "Input"],
Cell[89226, 2978, 671, 24, 44, "Text"],
Cell[89900, 3004, 353, 11, 54, "Input"],
Cell[90256, 3017, 815, 25, 65, "Text"],
Cell[91074, 3044, 451, 15, 39, "Text"],
Cell[91528, 3061, 452, 13, 57, "Input"],
Cell[91983, 3076, 288, 8, 29, "Text"],
Cell[92274, 3086, 128, 3, 41, "Input"],
Cell[92405, 3091, 149, 4, 29, "Text"],
Cell[92557, 3097, 779, 25, 62, "Input"],
Cell[93339, 3124, 138, 3, 29, "Text"],
Cell[93480, 3129, 866, 28, 62, "Input"],
Cell[94349, 3159, 560, 15, 62, "Input"],
Cell[94912, 3176, 139, 3, 29, "Text"],
Cell[95054, 3181, 647, 21, 57, "Input"],
Cell[95704, 3204, 508, 17, 29, "Text"],
Cell[96215, 3223, 167, 4, 41, "Input"],
Cell[96385, 3229, 509, 15, 84, "Input"],
Cell[96897, 3246, 1270, 38, 64, "Text"],
Cell[98170, 3286, 1349, 39, 101, "Text"],
Cell[99522, 3327, 697, 18, 65, "Text"],
Cell[100222, 3347, 750, 23, 57, "Input"],
Cell[100975, 3372, 138, 3, 29, "Text"],
Cell[101116, 3377, 544, 18, 57, "Input"],
Cell[101663, 3397, 344, 9, 47, "Text"],
Cell[102010, 3408, 234, 6, 41, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102281, 3419, 116, 1, 36, "Subsection"],
Cell[102400, 3422, 806, 22, 119, "Text"],
Cell[103209, 3446, 389, 10, 47, "Text"],
Cell[103601, 3458, 1099, 39, 47, "Text"],
Cell[104703, 3499, 155, 3, 29, "Text"],
Cell[104861, 3504, 780, 23, 62, "Input"],
Cell[105644, 3529, 404, 10, 47, "Text"],
Cell[106051, 3541, 380, 9, 41, "Input"],
Cell[106434, 3552, 163, 2, 29, "Text"],
Cell[106600, 3556, 2132, 55, 122, "Input"],
Cell[108735, 3613, 135, 3, 29, "Text"],
Cell[108873, 3618, 1970, 56, 122, "Input"],
Cell[110846, 3676, 733, 18, 62, "Input"],
Cell[111582, 3696, 481, 10, 65, "Text"],
Cell[112066, 3708, 297, 7, 109, "Input"],
Cell[112366, 3717, 91, 1, 29, "Text"],
Cell[112460, 3720, 723, 23, 62, "Input"],
Cell[113186, 3745, 128, 3, 29, "Text"],
Cell[113317, 3750, 441, 12, 41, "Input"],
Cell[113761, 3764, 819, 23, 62, "Input"],
Cell[114583, 3789, 176, 4, 29, "Text"],
Cell[114762, 3795, 873, 28, 62, "Input"],
Cell[115638, 3825, 424, 12, 41, "Input"],
Cell[116065, 3839, 176, 2, 29, "Text"],
Cell[116244, 3843, 409, 12, 41, "Input"],
Cell[116656, 3857, 237, 5, 29, "Text"],
Cell[116896, 3864, 3926, 112, 305, "Input"],
Cell[CellGroupData[{
Cell[120847, 3980, 2438, 61, 242, "Input"],
Cell[123288, 4043, 2381, 41, 85, "Output"]
}, Open  ]],
Cell[125684, 4087, 2110, 60, 182, "Input"],
Cell[127797, 4149, 500, 14, 41, "Input"],
Cell[128300, 4165, 2301, 53, 182, "Input"],
Cell[130604, 4220, 101, 1, 29, "Text"],
Cell[130708, 4223, 2614, 68, 214, "Input"],
Cell[133325, 4293, 3166, 77, 222, "Input"],
Cell[136494, 4372, 188, 2, 29, "Text"],
Cell[136685, 4376, 2825, 86, 218, "Input"],
Cell[139513, 4464, 1430, 42, 51, "Text"],
Cell[140946, 4508, 1959, 51, 102, "Input"],
Cell[142908, 4561, 251, 8, 29, "Text"],
Cell[143162, 4571, 422, 14, 62, "Input"],
Cell[143587, 4587, 98, 1, 29, "Text"],
Cell[143688, 4590, 551, 17, 62, "Input"],
Cell[144242, 4609, 129, 1, 29, "Text"],
Cell[144374, 4612, 1349, 39, 82, "Input"],
Cell[145726, 4653, 122, 1, 29, "Text"],
Cell[145851, 4656, 1315, 38, 62, "Input"],
Cell[147169, 4696, 127, 1, 29, "Text"],
Cell[147299, 4699, 1847, 50, 142, "Input"],
Cell[149149, 4751, 578, 9, 41, "Input"],
Cell[149730, 4762, 169, 3, 41, "Input"],
Cell[149902, 4767, 213, 5, 41, "Input"],
Cell[150118, 4774, 257, 7, 29, "Text"],
Cell[150378, 4783, 244, 4, 47, "Text"],
Cell[150625, 4789, 9269, 243, 513, "Input"],
Cell[159897, 5034, 159, 3, 29, "Text"],
Cell[160059, 5039, 15805, 419, 968, "Input"],
Cell[175867, 5460, 686, 16, 62, "Input"],
Cell[176556, 5478, 200, 4, 29, "Text"],
Cell[176759, 5484, 2054, 38, 174, "Text"],
Cell[178816, 5524, 172, 2, 29, "Text"],
Cell[178991, 5528, 4454, 78, 64, "Text"],
Cell[183448, 5608, 9931, 258, 646, "Input"],
Cell[193382, 5868, 666, 13, 41, "Input"],
Cell[194051, 5883, 224, 5, 47, "Text"],
Cell[194278, 5890, 1267, 38, 99, "Input"],
Cell[195548, 5930, 120, 1, 29, "Text"],
Cell[195671, 5933, 427, 11, 41, "Input"],
Cell[196101, 5946, 115, 1, 29, "Text"],
Cell[196219, 5949, 514, 13, 62, "Input"],
Cell[196736, 5964, 136, 3, 29, "Text"],
Cell[196875, 5969, 626, 16, 62, "Input"],
Cell[197504, 5987, 2432, 68, 142, "Input"],
Cell[199939, 6057, 1949, 54, 142, "Input"],
Cell[201891, 6113, 162, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[202078, 6120, 134, 2, 41, "Input"],
Cell[202215, 6124, 1077, 22, 166, "Output"]
}, Open  ]],
Cell[203307, 6149, 137, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[203469, 6154, 85, 1, 41, "Input"],
Cell[203557, 6157, 721, 15, 128, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204315, 6177, 102, 1, 27, "Subsubsection"],
Cell[204420, 6180, 280, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[204725, 6189, 1909, 53, 182, "Input"],
Cell[206637, 6244, 530, 11, 329, "Output"]
}, Open  ]],
Cell[207182, 6258, 280, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[207487, 6267, 2123, 58, 202, "Input"],
Cell[209613, 6327, 1507, 26, 338, "Output"]
}, Open  ]],
Cell[211135, 6356, 303, 7, 47, "Text"],
Cell[CellGroupData[{
Cell[211463, 6367, 2891, 67, 322, "Input"],
Cell[214357, 6436, 4744, 84, 385, "Output"]
}, Open  ]],
Cell[219116, 6523, 246, 6, 47, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219411, 6535, 117, 1, 36, "Subsection"],
Cell[219531, 6538, 251, 6, 65, "Text"],
Cell[219785, 6546, 1023, 17, 155, "Text"],
Cell[220811, 6565, 295, 7, 47, "Text"],
Cell[221109, 6574, 2110, 56, 102, "Input"],
Cell[223222, 6632, 183, 4, 29, "Text"],
Cell[223408, 6638, 2592, 78, 159, "Input"],
Cell[226003, 6718, 218, 5, 47, "Text"],
Cell[226224, 6725, 2070, 61, 130, "Input"],
Cell[228297, 6788, 423, 13, 41, "Input"],
Cell[CellGroupData[{
Cell[228745, 6805, 76, 1, 27, "Subsubsection"],
Cell[228824, 6808, 2347, 69, 111, "Text"],
Cell[231174, 6879, 674, 20, 62, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
